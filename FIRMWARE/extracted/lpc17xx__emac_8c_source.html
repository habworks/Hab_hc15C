<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LPC1700CMSIS Standard Peripheral Firmware Library Manual: C:/nxpdrv/LPC1700CMSIS/Drivers/source/lpc17xx_emac.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>C:/nxpdrv/LPC1700CMSIS/Drivers/source/lpc17xx_emac.c</h1><a href="lpc17xx__emac_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* $Id$          lpc17xx_dac.c                           2010-05-21</span>
<a name="l00003"></a>00003 <span class="comment">*/</span>
<a name="l00027"></a>00027 <span class="comment">/* Peripheral group ----------------------------------------------------------- */</span>
<a name="l00032"></a>00032 <span class="comment">/* Includes ------------------------------------------------------------------- */</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="lpc17xx__emac_8h.html" title="Contains all macro definitions and function prototypes support for Ethernet MAC firmware...">lpc17xx_emac.h</a>"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include "<a class="code" href="lpc17xx__clkpwr_8h.html" title="Contains all macro definitions and function prototypes support for Clock and Power...">lpc17xx_clkpwr.h</a>"</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="comment">/* If this source file built with example, the LPC17xx FW library configuration</span>
<a name="l00037"></a>00037 <span class="comment"> * file in each example directory ("lpc17xx_libcfg.h") must be included,</span>
<a name="l00038"></a>00038 <span class="comment"> * otherwise the default FW library configuration file must be included instead</span>
<a name="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040"></a>00040 <span class="preprocessor">#ifdef __BUILD_WITH_EXAMPLE__</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span><span class="preprocessor">#include "lpc17xx_libcfg.h"</span>
<a name="l00042"></a>00042 <span class="preprocessor">#else</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="lpc17xx__libcfg__default_8h.html" title="Default Library configuration header file.">lpc17xx_libcfg_default.h</a>"</span>
<a name="l00044"></a>00044 <span class="preprocessor">#endif </span><span class="comment">/* __BUILD_WITH_EXAMPLE__ */</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#ifdef _EMAC</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00049"></a>00049 <span class="comment">/* Private Variables ---------------------------------------------------------- */</span>
<a name="l00054"></a>00054 <span class="comment">/* MII Mgmt Configuration register - Clock divider setting */</span>
<a name="l00055"></a><a class="code" href="group___e_m_a_c___private___variables.html#g34c9ce702fa48f8d212e6fb2ee21c205">00055</a> <span class="keyword">const</span> uint8_t <a class="code" href="group___e_m_a_c___private___variables.html#g34c9ce702fa48f8d212e6fb2ee21c205">EMAC_clkdiv</a>[] = { 4, 6, 8, 10, 14, 20, 28 };
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">/* EMAC local DMA Descriptors */</span>
<a name="l00058"></a>00058 
<a name="l00060"></a>00060 <span class="keyword">static</span> <a class="code" href="struct_r_x___desc.html" title="RX Descriptor structure type definition.">RX_Desc</a> Rx_Desc[<a class="code" href="group___e_m_a_c___private___macros.html#gd32b6ab5507a03edf7ce86ec720e187d">EMAC_NUM_RX_FRAG</a>];
<a name="l00061"></a>00061 
<a name="l00063"></a>00063 <span class="preprocessor">#if defined ( __CC_ARM   )</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span><span class="keyword">static</span> __align(8) <a class="code" href="struct_r_x___stat.html" title="RX Status structure type definition.">RX_Stat</a> Rx_Stat[<a class="code" href="group___e_m_a_c___private___macros.html#gd32b6ab5507a03edf7ce86ec720e187d">EMAC_NUM_RX_FRAG</a>];
<a name="l00065"></a>00065 <span class="preprocessor">#elif defined ( __ICCARM__ )</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span><span class="preprocessor">#pragma data_alignment=8</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="struct_r_x___stat.html" title="RX Status structure type definition.">RX_Stat</a> Rx_Stat[EMAC_NUM_RX_FRAG];
<a name="l00068"></a>00068 <span class="preprocessor">#elif defined   (  __GNUC__  )</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="group___e_m_a_c___emac_raw.html#g59af7da1a6bc690a91c25ffb643be295">__attribute__</a> ((aligned (8))) <a class="code" href="struct_r_x___stat.html" title="RX Status structure type definition.">RX_Stat</a> Rx_Stat[EMAC_NUM_RX_FRAG];
<a name="l00070"></a>00070 <span class="preprocessor">#endif</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span>
<a name="l00073"></a>00073 <span class="keyword">static</span> <a class="code" href="struct_t_x___desc.html" title="TX Descriptor structure type definition.">TX_Desc</a> Tx_Desc[<a class="code" href="group___e_m_a_c___private___macros.html#g935cd0225e96d031ea7f484d614f10c6">EMAC_NUM_TX_FRAG</a>];
<a name="l00075"></a>00075 <span class="keyword">static</span> <a class="code" href="struct_t_x___stat.html" title="TX Status structure type definition.">TX_Stat</a> Tx_Stat[<a class="code" href="group___e_m_a_c___private___macros.html#g935cd0225e96d031ea7f484d614f10c6">EMAC_NUM_TX_FRAG</a>];
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">/* EMAC local DMA buffers */</span>
<a name="l00079"></a>00079 <span class="keyword">static</span> uint32_t <a class="code" href="group___u_a_r_t___d_m_a.html#gd0058b3087d4cf1d597d7b45eac606c6">rx_buf</a>[EMAC_NUM_RX_FRAG][<a class="code" href="group___e_m_a_c___private___macros.html#g58d37bc982406d2dfc86503abb1e5abe">EMAC_ETH_MAX_FLEN</a>&gt;&gt;2];
<a name="l00081"></a>00081 <span class="keyword">static</span> uint32_t tx_buf[<a class="code" href="group___e_m_a_c___private___macros.html#g935cd0225e96d031ea7f484d614f10c6">EMAC_NUM_TX_FRAG</a>][<a class="code" href="group___e_m_a_c___private___macros.html#g58d37bc982406d2dfc86503abb1e5abe">EMAC_ETH_MAX_FLEN</a>&gt;&gt;2];
<a name="l00082"></a>00082 
<a name="l00087"></a>00087 <span class="comment">/* Private Functions ---------------------------------------------------------- */</span>
<a name="l00088"></a>00088 <span class="keyword">static</span> <span class="keywordtype">void</span> rx_descr_init (<span class="keywordtype">void</span>);
<a name="l00089"></a>00089 <span class="keyword">static</span> <span class="keywordtype">void</span> tx_descr_init (<span class="keywordtype">void</span>);
<a name="l00090"></a>00090 <span class="keyword">static</span> int32_t write_PHY (uint32_t PhyReg, uint16_t Value);
<a name="l00091"></a>00091 <span class="keyword">static</span> int32_t  read_PHY (uint32_t PhyReg);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="keyword">static</span> <span class="keywordtype">void</span> setEmacAddr(uint8_t abStationAddr[]);
<a name="l00094"></a>00094 <span class="keyword">static</span> int32_t emac_CRCCalc(uint8_t frame_no_fcs[], int32_t frame_len);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="comment">/*--------------------------- rx_descr_init ---------------------------------*/</span>
<a name="l00098"></a>00098 <span class="comment">/*********************************************************************/</span>
<a name="l00103"></a>00103 <span class="keyword">static</span> <span class="keywordtype">void</span> rx_descr_init (<span class="keywordtype">void</span>)
<a name="l00104"></a>00104 {
<a name="l00105"></a>00105         <span class="comment">/* Initialize Receive Descriptor and Status array. */</span>
<a name="l00106"></a>00106         uint32_t i;
<a name="l00107"></a>00107 
<a name="l00108"></a>00108         <span class="keywordflow">for</span> (i = 0; i &lt; EMAC_NUM_RX_FRAG; i++) {
<a name="l00109"></a>00109                 Rx_Desc[i].<a class="code" href="struct_r_x___desc.html#f068a5f8f80955f4fd404b2d32db46c3">Packet</a>  = (uint32_t)&amp;rx_buf[i];
<a name="l00110"></a>00110                 Rx_Desc[i].<a class="code" href="struct_r_x___desc.html#61f3009f20098b265c20d37fd9bae6ef">Ctrl</a>    = <a class="code" href="group___e_m_a_c___private___macros.html#gd6743f05efc81797052df72f95a6cdb1">EMAC_RCTRL_INT</a> | (<a class="code" href="group___e_m_a_c___private___macros.html#g58d37bc982406d2dfc86503abb1e5abe">EMAC_ETH_MAX_FLEN</a> - 1);
<a name="l00111"></a>00111                 Rx_Stat[i].Info    = 0;
<a name="l00112"></a>00112                 Rx_Stat[i].HashCRC = 0;
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         <span class="comment">/* Set EMAC Receive Descriptor Registers. */</span>
<a name="l00116"></a>00116         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxDescriptor       = (uint32_t)&amp;Rx_Desc[0];
<a name="l00117"></a>00117         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxStatus           = (uint32_t)&amp;Rx_Stat[0];
<a name="l00118"></a>00118         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxDescriptorNumber = EMAC_NUM_RX_FRAG - 1;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120         <span class="comment">/* Rx Descriptors Point to 0 */</span>
<a name="l00121"></a>00121         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxConsumeIndex  = 0;
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 <span class="comment">/*--------------------------- tx_descr_init ---- ----------------------------*/</span>
<a name="l00126"></a>00126 <span class="comment">/*********************************************************************/</span>
<a name="l00131"></a>00131 <span class="keyword">static</span> <span class="keywordtype">void</span> tx_descr_init (<span class="keywordtype">void</span>) {
<a name="l00132"></a>00132         <span class="comment">/* Initialize Transmit Descriptor and Status array. */</span>
<a name="l00133"></a>00133         uint32_t i;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group___e_m_a_c___private___macros.html#g935cd0225e96d031ea7f484d614f10c6">EMAC_NUM_TX_FRAG</a>; i++) {
<a name="l00136"></a>00136                 Tx_Desc[i].Packet = (uint32_t)&amp;tx_buf[i];
<a name="l00137"></a>00137                 Tx_Desc[i].Ctrl   = 0;
<a name="l00138"></a>00138                 Tx_Stat[i].<a class="code" href="struct_t_x___stat.html#ebf62e7e11da4f025a27cd87a552d30d">Info</a>   = 0;
<a name="l00139"></a>00139         }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141         <span class="comment">/* Set EMAC Transmit Descriptor Registers. */</span>
<a name="l00142"></a>00142         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;TxDescriptor       = (uint32_t)&amp;Tx_Desc[0];
<a name="l00143"></a>00143         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;TxStatus           = (uint32_t)&amp;Tx_Stat[0];
<a name="l00144"></a>00144         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;TxDescriptorNumber = EMAC_NUM_TX_FRAG - 1;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146         <span class="comment">/* Tx Descriptors Point to 0 */</span>
<a name="l00147"></a>00147         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;TxProduceIndex  = 0;
<a name="l00148"></a>00148 }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 <span class="comment">/*--------------------------- write_PHY -------------------------------------*/</span>
<a name="l00152"></a>00152 <span class="comment">/*********************************************************************/</span>
<a name="l00159"></a>00159 <span class="keyword">static</span> int32_t write_PHY (uint32_t PhyReg, uint16_t Value)
<a name="l00160"></a>00160 {
<a name="l00161"></a>00161         <span class="comment">/* Write a data 'Value' to PHY register 'PhyReg'. */</span>
<a name="l00162"></a>00162         uint32_t tout;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MADR = <a class="code" href="group___e_m_a_c___private___macros.html#g8ef498b69536224ab2e626e16025e498">EMAC_DEF_ADR</a> | PhyReg;
<a name="l00165"></a>00165         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MWTD = Value;
<a name="l00166"></a>00166 
<a name="l00167"></a>00167         <span class="comment">/* Wait until operation completed */</span>
<a name="l00168"></a>00168         tout = 0;
<a name="l00169"></a>00169         <span class="keywordflow">for</span> (tout = 0; tout &lt; <a class="code" href="group___e_m_a_c___private___macros.html#gecb5a0f1eb96c76f0314b0d8f20d6c30">EMAC_MII_WR_TOUT</a>; tout++) {
<a name="l00170"></a>00170                 <span class="keywordflow">if</span> ((<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MIND &amp; <a class="code" href="group___e_m_a_c___private___macros.html#g0cd77b33f5c92c618a99c419f14809b6">EMAC_MIND_BUSY</a>) == 0) {
<a name="l00171"></a>00171                         <span class="keywordflow">return</span> (0);
<a name="l00172"></a>00172                 }
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174         <span class="comment">// Time out!</span>
<a name="l00175"></a>00175         <span class="keywordflow">return</span> (-1);
<a name="l00176"></a>00176 }
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="comment">/*--------------------------- read_PHY --------------------------------------*/</span>
<a name="l00180"></a>00180 <span class="comment">/*********************************************************************/</span>
<a name="l00186"></a>00186 <span class="keyword">static</span> int32_t read_PHY (uint32_t PhyReg)
<a name="l00187"></a>00187 {
<a name="l00188"></a>00188         <span class="comment">/* Read a PHY register 'PhyReg'. */</span>
<a name="l00189"></a>00189         uint32_t tout;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MADR = <a class="code" href="group___e_m_a_c___private___macros.html#g8ef498b69536224ab2e626e16025e498">EMAC_DEF_ADR</a> | PhyReg;
<a name="l00192"></a>00192         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MCMD = <a class="code" href="group___e_m_a_c___private___macros.html#g4488dce71c84fa1bc9a1829e7e065ced">EMAC_MCMD_READ</a>;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194         <span class="comment">/* Wait until operation completed */</span>
<a name="l00195"></a>00195         tout = 0;
<a name="l00196"></a>00196         <span class="keywordflow">for</span> (tout = 0; tout &lt; <a class="code" href="group___e_m_a_c___private___macros.html#gb95b67a347ee27ee42cb90087a01d7e6">EMAC_MII_RD_TOUT</a>; tout++) {
<a name="l00197"></a>00197                 <span class="keywordflow">if</span> ((<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MIND &amp; <a class="code" href="group___e_m_a_c___private___macros.html#g0cd77b33f5c92c618a99c419f14809b6">EMAC_MIND_BUSY</a>) == 0) {
<a name="l00198"></a>00198                         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MCMD = 0;
<a name="l00199"></a>00199                         <span class="keywordflow">return</span> (<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MRDD);
<a name="l00200"></a>00200                 }
<a name="l00201"></a>00201         }
<a name="l00202"></a>00202         <span class="comment">// Time out!</span>
<a name="l00203"></a>00203         <span class="keywordflow">return</span> (-1);
<a name="l00204"></a>00204 }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="comment">/*********************************************************************/</span>
<a name="l00212"></a>00212 <span class="keyword">static</span> <span class="keywordtype">void</span> setEmacAddr(uint8_t abStationAddr[])
<a name="l00213"></a>00213 {
<a name="l00214"></a>00214         <span class="comment">/* Set the Ethernet MAC Address registers */</span>
<a name="l00215"></a>00215         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;SA0 = ((uint32_t)abStationAddr[5] &lt;&lt; 8) | (uint32_t)abStationAddr[4];
<a name="l00216"></a>00216         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;SA1 = ((uint32_t)abStationAddr[3] &lt;&lt; 8) | (uint32_t)abStationAddr[2];
<a name="l00217"></a>00217         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;SA2 = ((uint32_t)abStationAddr[1] &lt;&lt; 8) | (uint32_t)abStationAddr[0];
<a name="l00218"></a>00218 }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 <span class="comment">/*********************************************************************/</span>
<a name="l00227"></a>00227 <span class="keyword">static</span> int32_t emac_CRCCalc(uint8_t frame_no_fcs[], int32_t frame_len)
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229         <span class="keywordtype">int</span> i;          <span class="comment">// iterator</span>
<a name="l00230"></a>00230         <span class="keywordtype">int</span> j;          <span class="comment">// another iterator</span>
<a name="l00231"></a>00231         <span class="keywordtype">char</span> byte;      <span class="comment">// current byte</span>
<a name="l00232"></a>00232         <span class="keywordtype">int</span> crc;        <span class="comment">// CRC result</span>
<a name="l00233"></a>00233         <span class="keywordtype">int</span> q0, q1, q2, q3; <span class="comment">// temporary variables</span>
<a name="l00234"></a>00234         crc = 0xFFFFFFFF;
<a name="l00235"></a>00235         <span class="keywordflow">for</span> (i = 0; i &lt; frame_len; i++) {
<a name="l00236"></a>00236                 byte = *frame_no_fcs++;
<a name="l00237"></a>00237                 <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) {
<a name="l00238"></a>00238                         <span class="keywordflow">if</span> (((crc &gt;&gt; 28) ^ (byte &gt;&gt; 3)) &amp; 0x00000001) {
<a name="l00239"></a>00239                                 q3 = 0x04C11DB7;
<a name="l00240"></a>00240                         } <span class="keywordflow">else</span> {
<a name="l00241"></a>00241                                 q3 = 0x00000000;
<a name="l00242"></a>00242                         }
<a name="l00243"></a>00243                         <span class="keywordflow">if</span> (((crc &gt;&gt; 29) ^ (byte &gt;&gt; 2)) &amp; 0x00000001) {
<a name="l00244"></a>00244                                 q2 = 0x09823B6E;
<a name="l00245"></a>00245                         } <span class="keywordflow">else</span> {
<a name="l00246"></a>00246                                 q2 = 0x00000000;
<a name="l00247"></a>00247                         }
<a name="l00248"></a>00248                         <span class="keywordflow">if</span> (((crc &gt;&gt; 30) ^ (byte &gt;&gt; 1)) &amp; 0x00000001) {
<a name="l00249"></a>00249                                 q1 = 0x130476DC;
<a name="l00250"></a>00250                         } <span class="keywordflow">else</span> {
<a name="l00251"></a>00251                                 q1 = 0x00000000;
<a name="l00252"></a>00252                         }
<a name="l00253"></a>00253                         <span class="keywordflow">if</span> (((crc &gt;&gt; 31) ^ (byte &gt;&gt; 0)) &amp; 0x00000001) {
<a name="l00254"></a>00254                                 q0 = 0x2608EDB8;
<a name="l00255"></a>00255                         } <span class="keywordflow">else</span> {
<a name="l00256"></a>00256                                 q0 = 0x00000000;
<a name="l00257"></a>00257                         }
<a name="l00258"></a>00258                         crc = (crc &lt;&lt; 4) ^ q3 ^ q2 ^ q1 ^ q0;
<a name="l00259"></a>00259                         byte &gt;&gt;= 4;
<a name="l00260"></a>00260                 }
<a name="l00261"></a>00261         }
<a name="l00262"></a>00262         <span class="keywordflow">return</span> crc;
<a name="l00263"></a>00263 }
<a name="l00264"></a>00264 <span class="comment">/* End of Private Functions --------------------------------------------------- */</span>
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">/* Public Functions ----------------------------------------------------------- */</span>
<a name="l00273"></a>00273 <span class="comment">/*********************************************************************/</span>
<a name="l00292"></a><a class="code" href="group___e_m_a_c___public___functions.html#g0aa0e60db6822c59fc8482d8698baab4">00292</a> <a class="code" href="group___l_p_c___types___public___types.html#g67a0db04d321a74b7e7fcfd3f1a3f70b">Status</a> <a class="code" href="group___e_m_a_c___public___functions.html#g0aa0e60db6822c59fc8482d8698baab4" title="Initializes the EMAC peripheral according to the specified parameters in the EMAC_ConfigStruct...">EMAC_Init</a>(<a class="code" href="struct_e_m_a_c___c_f_g___type.html" title="EMAC configuration structure definition.">EMAC_CFG_Type</a> *EMAC_ConfigStruct)
<a name="l00293"></a>00293 {
<a name="l00294"></a>00294         <span class="comment">/* Initialize the EMAC Ethernet controller. */</span>
<a name="l00295"></a>00295         int32_t regv,tout, tmp;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297         <span class="comment">/* Set up clock and power for Ethernet module */</span>
<a name="l00298"></a>00298         <a class="code" href="group___c_l_k_p_w_r___public___functions.html#gc29f7879a37c604a1040499001ba0121" title="Configure power supply for each peripheral according to NewState.">CLKPWR_ConfigPPWR</a> (<a class="code" href="group___c_l_k_p_w_r___public___macros.html#gf5641763b6a54ad0b80c97ed1c70f838">CLKPWR_PCONP_PCENET</a>, <a class="code" href="group___l_p_c___types___public___types.html#ggc9a7e9a35d2513ec15c3b537aaa4fba17d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);
<a name="l00299"></a>00299 
<a name="l00300"></a>00300         <span class="comment">/* Reset all EMAC internal modules */</span>
<a name="l00301"></a>00301         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MAC1    = <a class="code" href="group___e_m_a_c___private___macros.html#g23449e5e01f55c76e9eba4f710a3a142">EMAC_MAC1_RES_TX</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g214cfe49444b5bac7866889384698037">EMAC_MAC1_RES_MCS_TX</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g8b6b11dbbef1c328f1ffa75a04d34649">EMAC_MAC1_RES_RX</a> |
<a name="l00302"></a>00302                                         <a class="code" href="group___e_m_a_c___private___macros.html#g134a14de4a380ea61268d157a3f6ad1a">EMAC_MAC1_RES_MCS_RX</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g1ca6860eff6addc14ab0cff18d2e5a46">EMAC_MAC1_SIM_RES</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g1f4a4efdfcb6cbba405aa3cc72ebf657">EMAC_MAC1_SOFT_RES</a>;
<a name="l00303"></a>00303 
<a name="l00304"></a>00304         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;Command = <a class="code" href="group___e_m_a_c___private___macros.html#g80d00b11636e69d095d914e415fa5a1e">EMAC_CR_REG_RES</a> | <a class="code" href="group___e_m_a_c___private___macros.html#gbd209ec9e17f13b5f31fa55007011022">EMAC_CR_TX_RES</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g82c0b530953c72d5c0c1b4313fbee9d5">EMAC_CR_RX_RES</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g43b97c6aa427bb7a4fe6a3390faebbe7">EMAC_CR_PASS_RUNT_FRM</a>;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306         <span class="comment">/* A short delay after reset. */</span>
<a name="l00307"></a>00307         <span class="keywordflow">for</span> (tout = 100; tout; tout--);
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         <span class="comment">/* Initialize MAC control registers. */</span>
<a name="l00310"></a>00310         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MAC1 = <a class="code" href="group___e_m_a_c___private___macros.html#gecafe47b0ef6bf3e0ac573bb56f58649">EMAC_MAC1_PASS_ALL</a>;
<a name="l00311"></a>00311         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MAC2 = <a class="code" href="group___e_m_a_c___private___macros.html#g4d39d6e5a9c4286243c90e6d6c08d8fa">EMAC_MAC2_CRC_EN</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g8a27eea17b87852537d64ce0042d932a">EMAC_MAC2_PAD_EN</a>;
<a name="l00312"></a>00312         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MAXF = <a class="code" href="group___e_m_a_c___private___macros.html#g58d37bc982406d2dfc86503abb1e5abe">EMAC_ETH_MAX_FLEN</a>;
<a name="l00313"></a>00313         <span class="comment">/*</span>
<a name="l00314"></a>00314 <span class="comment">         * Find the clock that close to desired target clock</span>
<a name="l00315"></a>00315 <span class="comment">         */</span>
<a name="l00316"></a>00316         tmp = <a class="code" href="group___l_p_c17xx___system___public___variables.html#ga3cd3e43291e81e795d642b79b6088e6">SystemCoreClock</a> / <a class="code" href="group___e_m_a_c___private___macros.html#gf283db0059cdb43495fd871223a31323">EMAC_MCFG_MII_MAXCLK</a>;
<a name="l00317"></a>00317         <span class="keywordflow">for</span> (tout = 0; tout &lt; <span class="keyword">sizeof</span> (<a class="code" href="group___e_m_a_c___private___variables.html#g34c9ce702fa48f8d212e6fb2ee21c205">EMAC_clkdiv</a>); tout++){
<a name="l00318"></a>00318                 <span class="keywordflow">if</span> (<a class="code" href="group___e_m_a_c___private___variables.html#g34c9ce702fa48f8d212e6fb2ee21c205">EMAC_clkdiv</a>[tout] &gt;= tmp) <span class="keywordflow">break</span>;
<a name="l00319"></a>00319         }
<a name="l00320"></a>00320         tout++;
<a name="l00321"></a>00321         <span class="comment">// Write to MAC configuration register and reset</span>
<a name="l00322"></a>00322         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MCFG = <a class="code" href="group___e_m_a_c___private___macros.html#g3c0c679cb21583b8a4bfa618c82fd3ee">EMAC_MCFG_CLK_SEL</a>(tout) | <a class="code" href="group___e_m_a_c___private___macros.html#g8a00b82c56540cfd9feac11da02f3bf1">EMAC_MCFG_RES_MII</a>;
<a name="l00323"></a>00323         <span class="comment">// release reset</span>
<a name="l00324"></a>00324         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MCFG &amp;= ~(<a class="code" href="group___e_m_a_c___private___macros.html#g8a00b82c56540cfd9feac11da02f3bf1">EMAC_MCFG_RES_MII</a>);
<a name="l00325"></a>00325         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;CLRT = <a class="code" href="group___e_m_a_c___private___macros.html#g9dd9d0e0636b30ba30f807739162cb03">EMAC_CLRT_DEF</a>;
<a name="l00326"></a>00326         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IPGR = <a class="code" href="group___e_m_a_c___private___macros.html#g3ba8c2d804d34874f1e90250d1782e67">EMAC_IPGR_P2_DEF</a>;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328         <span class="comment">/* Enable Reduced MII interface. */</span>
<a name="l00329"></a>00329         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;Command = <a class="code" href="group___e_m_a_c___private___macros.html#ga385434bf367fbb86480da4682b49152">EMAC_CR_RMII</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g43b97c6aa427bb7a4fe6a3390faebbe7">EMAC_CR_PASS_RUNT_FRM</a>;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331         <span class="comment">/* Reset Reduced MII Logic. */</span>
<a name="l00332"></a>00332         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;SUPP = <a class="code" href="group___e_m_a_c___private___macros.html#g066831afd0fdf3c508522604e6c1922d">EMAC_SUPP_RES_RMII</a>;
<a name="l00333"></a>00333 
<a name="l00334"></a>00334         <span class="keywordflow">for</span> (tout = 100; tout; tout--);
<a name="l00335"></a>00335         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;SUPP = 0;
<a name="l00336"></a>00336 
<a name="l00337"></a>00337         <span class="comment">/* Put the DP83848C in reset mode */</span>
<a name="l00338"></a>00338         write_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g668453deab2030352349c9878f187689">EMAC_PHY_REG_BMCR</a>, <a class="code" href="group___e_m_a_c___private___macros.html#g31ff2282ab7d8119471290530f1322f1">EMAC_PHY_BMCR_RESET</a>);
<a name="l00339"></a>00339 
<a name="l00340"></a>00340         <span class="comment">/* Wait for hardware reset to end. */</span>
<a name="l00341"></a>00341         <span class="keywordflow">for</span> (tout = <a class="code" href="group___e_m_a_c___private___macros.html#gc7f3564ded9d9f076b675010c8c73b0a">EMAC_PHY_RESP_TOUT</a>; tout; tout--) {
<a name="l00342"></a>00342                 regv = read_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g668453deab2030352349c9878f187689">EMAC_PHY_REG_BMCR</a>);
<a name="l00343"></a>00343                 <span class="keywordflow">if</span> (!(regv &amp; (<a class="code" href="group___e_m_a_c___private___macros.html#g31ff2282ab7d8119471290530f1322f1">EMAC_PHY_BMCR_RESET</a> | <a class="code" href="group___e_m_a_c___private___macros.html#ge3eb38fc86ac2bda5314bbb1003dfd62">EMAC_PHY_BMCR_POWERDOWN</a>))) {
<a name="l00344"></a>00344                         <span class="comment">/* Reset complete, device not Power Down. */</span>
<a name="l00345"></a>00345                         <span class="keywordflow">break</span>;
<a name="l00346"></a>00346                 }
<a name="l00347"></a>00347                 <span class="keywordflow">if</span> (tout == 0){
<a name="l00348"></a>00348                         <span class="comment">// Time out, return ERROR</span>
<a name="l00349"></a>00349                         <span class="keywordflow">return</span> (<a class="code" href="group___l_p_c___types___public___types.html#gg67a0db04d321a74b7e7fcfd3f1a3f70b2fd6f336d08340583bd620a7f5694c90">ERROR</a>);
<a name="l00350"></a>00350                 }
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353         <span class="comment">// Set PHY mode</span>
<a name="l00354"></a>00354         <span class="keywordflow">if</span> (<a class="code" href="group___e_m_a_c___public___functions.html#g4b06c4c3f311e1e8fd18bd1e6b268ef4" title="Set specified PHY mode in EMAC peripheral.">EMAC_SetPHYMode</a>(EMAC_ConfigStruct-&gt;<a class="code" href="struct_e_m_a_c___c_f_g___type.html#0ffc93ec511ed9cf1663f6939bd3e839">Mode</a>) &lt; 0){
<a name="l00355"></a>00355                 <span class="keywordflow">return</span> (<a class="code" href="group___l_p_c___types___public___types.html#gg67a0db04d321a74b7e7fcfd3f1a3f70b2fd6f336d08340583bd620a7f5694c90">ERROR</a>);
<a name="l00356"></a>00356         }
<a name="l00357"></a>00357 
<a name="l00358"></a>00358         <span class="comment">// Set EMAC address</span>
<a name="l00359"></a>00359         setEmacAddr(EMAC_ConfigStruct-&gt;<a class="code" href="struct_e_m_a_c___c_f_g___type.html#7c81db6116a037a19a6ab6fb12021c68">pbEMAC_Addr</a>);
<a name="l00360"></a>00360 
<a name="l00361"></a>00361         <span class="comment">/* Initialize Tx and Rx DMA Descriptors */</span>
<a name="l00362"></a>00362         rx_descr_init ();
<a name="l00363"></a>00363         tx_descr_init ();
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         <span class="comment">// Set Receive Filter register: enable broadcast and multicast</span>
<a name="l00366"></a>00366         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxFilterCtrl = <a class="code" href="group___e_m_a_c___private___macros.html#gc539fa2b807fb287d6c198eb8bc3b21c">EMAC_RFC_MCAST_EN</a> | <a class="code" href="group___e_m_a_c___private___macros.html#gfcba0f7bdf969c3a9e749ddb008ac642">EMAC_RFC_BCAST_EN</a> | <a class="code" href="group___e_m_a_c___private___macros.html#gade7aa3af3dfb494f119421ff24cb073">EMAC_RFC_PERFECT_EN</a>;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368         <span class="comment">/* Enable Rx Done and Tx Done interrupt for EMAC */</span>
<a name="l00369"></a>00369         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IntEnable = <a class="code" href="group___e_m_a_c___private___macros.html#g5220b1bdedd793330e7d19902f5b8cc7">EMAC_INT_RX_DONE</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g66d59fa523575ae7df29e8cf0aa409cd">EMAC_INT_TX_DONE</a>;
<a name="l00370"></a>00370 
<a name="l00371"></a>00371         <span class="comment">/* Reset all interrupts */</span>
<a name="l00372"></a>00372         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IntClear  = 0xFFFF;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374         <span class="comment">/* Enable receive and transmit mode of MAC Ethernet core */</span>
<a name="l00375"></a>00375         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;Command  |= (<a class="code" href="group___e_m_a_c___private___macros.html#gf8cc86b979d7a2ec7650c2b49743db83">EMAC_CR_RX_EN</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g16f39934be084f9cfd0760cac9612c3e">EMAC_CR_TX_EN</a>);
<a name="l00376"></a>00376         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MAC1     |= <a class="code" href="group___e_m_a_c___private___macros.html#g514e4a822ef6829cf7223df3a1fd3b81">EMAC_MAC1_REC_EN</a>;
<a name="l00377"></a>00377 
<a name="l00378"></a>00378         <span class="keywordflow">return</span> <a class="code" href="group___l_p_c___types___public___types.html#gg67a0db04d321a74b7e7fcfd3f1a3f70bc7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;
<a name="l00379"></a>00379 }
<a name="l00380"></a>00380 
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 <span class="comment">/*********************************************************************/</span>
<a name="l00388"></a><a class="code" href="group___e_m_a_c___public___functions.html#g30378e9ea98ec05e89e5567985ba752d">00388</a> <span class="keywordtype">void</span> <a class="code" href="group___e_m_a_c___public___functions.html#g30378e9ea98ec05e89e5567985ba752d" title="De-initializes the EMAC peripheral registers to their default reset values.">EMAC_DeInit</a>(<span class="keywordtype">void</span>)
<a name="l00389"></a>00389 {
<a name="l00390"></a>00390         <span class="comment">// Disable all interrupt</span>
<a name="l00391"></a>00391         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IntEnable = 0x00;
<a name="l00392"></a>00392         <span class="comment">// Clear all pending interrupt</span>
<a name="l00393"></a>00393         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IntClear = (0xFF) | (<a class="code" href="group___e_m_a_c___private___macros.html#gbc911c7e58f832af31c668661adbf63f">EMAC_INT_SOFT_INT</a> | <a class="code" href="group___e_m_a_c___private___macros.html#g0acb15113d6cc2224f333850d2aecb4f">EMAC_INT_WAKEUP</a>);
<a name="l00394"></a>00394 
<a name="l00395"></a>00395         <span class="comment">/* TurnOff clock and power for Ethernet module */</span>
<a name="l00396"></a>00396         <a class="code" href="group___c_l_k_p_w_r___public___functions.html#gc29f7879a37c604a1040499001ba0121" title="Configure power supply for each peripheral according to NewState.">CLKPWR_ConfigPPWR</a> (<a class="code" href="group___c_l_k_p_w_r___public___macros.html#gf5641763b6a54ad0b80c97ed1c70f838">CLKPWR_PCONP_PCENET</a>, <a class="code" href="group___l_p_c___types___public___types.html#ggc9a7e9a35d2513ec15c3b537aaa4fba1d3a9df141be0ccf10389b640f492b26d">DISABLE</a>);
<a name="l00397"></a>00397 }
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 <span class="comment">/*********************************************************************/</span>
<a name="l00420"></a><a class="code" href="group___e_m_a_c___public___functions.html#gb1e8b36d16bc87beea87a637777dd8ea">00420</a> int32_t <a class="code" href="group___e_m_a_c___public___functions.html#gb1e8b36d16bc87beea87a637777dd8ea" title="Check specified PHY status in EMAC peripheral.">EMAC_CheckPHYStatus</a>(uint32_t ulPHYState)
<a name="l00421"></a>00421 {
<a name="l00422"></a>00422         int32_t regv, tmp;
<a name="l00423"></a>00423 <span class="preprocessor">#ifdef MCB_LPC_1768</span>
<a name="l00424"></a>00424 <span class="preprocessor"></span>        regv = read_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#gb81231cf870148e245035dc9f08ce098">EMAC_PHY_REG_STS</a>);
<a name="l00425"></a>00425         <span class="keywordflow">switch</span>(ulPHYState){
<a name="l00426"></a>00426         <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#ge0abe34513341da57ea1172fd3382bd5">EMAC_PHY_STAT_LINK</a>:
<a name="l00427"></a>00427                 tmp = (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#ge900e0c2eb89f503113b6fb21e5802ac">EMAC_PHY_SR_LINK</a>) ? 1 : 0;
<a name="l00428"></a>00428                 <span class="keywordflow">break</span>;
<a name="l00429"></a>00429         <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#ge28e7ef0be2f6c9d26b9e5ddc5966281">EMAC_PHY_STAT_SPEED</a>:
<a name="l00430"></a>00430                 tmp = (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#g0613826cbb73f578c28df81726036103">EMAC_PHY_SR_SPEED</a>) ? 0 : 1;
<a name="l00431"></a>00431                 <span class="keywordflow">break</span>;
<a name="l00432"></a>00432         <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#gb11e8e4f1b2bded5e6fd1af33eff6296">EMAC_PHY_STAT_DUP</a>:
<a name="l00433"></a>00433                 tmp = (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#gc8c9e0931b22c907d4692bc655843808">EMAC_PHY_SR_FULL_DUP</a>) ? 1 : 0;
<a name="l00434"></a>00434                 <span class="keywordflow">break</span>;
<a name="l00435"></a>00435 <span class="preprocessor">#elif defined(IAR_LPC_1768)</span>
<a name="l00436"></a>00436 <span class="preprocessor"></span>        <span class="comment">/* Use IAR_LPC_1768 board:</span>
<a name="l00437"></a>00437 <span class="comment">         * FSZ8721BL doesn't have Status Register</span>
<a name="l00438"></a>00438 <span class="comment">         * so we read Basic Mode Status Register (0x01h) instead</span>
<a name="l00439"></a>00439 <span class="comment">         */</span>
<a name="l00440"></a>00440         regv = read_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g2a8674b42b04e5ba80a0f545b8b27f5a">EMAC_PHY_REG_BMSR</a>);
<a name="l00441"></a>00441         <span class="keywordflow">switch</span>(ulPHYState){
<a name="l00442"></a>00442         <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#ge0abe34513341da57ea1172fd3382bd5">EMAC_PHY_STAT_LINK</a>:
<a name="l00443"></a>00443                 tmp = (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#ga3c622875c53f67363dfefdf6dd7418a">EMAC_PHY_BMSR_LINK_STATUS</a>) ? 1 : 0;
<a name="l00444"></a>00444                 <span class="keywordflow">break</span>;
<a name="l00445"></a>00445         <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#ge28e7ef0be2f6c9d26b9e5ddc5966281">EMAC_PHY_STAT_SPEED</a>:
<a name="l00446"></a>00446                 tmp = (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#g658c866cfe4b1782af71e2864b65630f">EMAC_PHY_SR_100_SPEED</a>) ? 1 : 0;
<a name="l00447"></a>00447                 <span class="keywordflow">break</span>;
<a name="l00448"></a>00448         <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#gb11e8e4f1b2bded5e6fd1af33eff6296">EMAC_PHY_STAT_DUP</a>:
<a name="l00449"></a>00449                 tmp = (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#gc8c9e0931b22c907d4692bc655843808">EMAC_PHY_SR_FULL_DUP</a>) ? 1 : 0;
<a name="l00450"></a>00450                 <span class="keywordflow">break</span>;
<a name="l00451"></a>00451 <span class="preprocessor">#endif</span>
<a name="l00452"></a>00452 <span class="preprocessor"></span>        <span class="keywordflow">default</span>:
<a name="l00453"></a>00453                 tmp = -1;
<a name="l00454"></a>00454                 <span class="keywordflow">break</span>;
<a name="l00455"></a>00455         }
<a name="l00456"></a>00456         <span class="keywordflow">return</span> (tmp);
<a name="l00457"></a>00457 }
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 <span class="comment">/*********************************************************************/</span>
<a name="l00470"></a><a class="code" href="group___e_m_a_c___public___functions.html#g4b06c4c3f311e1e8fd18bd1e6b268ef4">00470</a> int32_t <a class="code" href="group___e_m_a_c___public___functions.html#g4b06c4c3f311e1e8fd18bd1e6b268ef4" title="Set specified PHY mode in EMAC peripheral.">EMAC_SetPHYMode</a>(uint32_t ulPHYMode)
<a name="l00471"></a>00471 {
<a name="l00472"></a>00472         int32_t id1, id2, tout, regv;
<a name="l00473"></a>00473 
<a name="l00474"></a>00474         <span class="comment">/* Check if this is a DP83848C PHY. */</span>
<a name="l00475"></a>00475         id1 = read_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g172d9870c434467cca494d575256bad8">EMAC_PHY_REG_IDR1</a>);
<a name="l00476"></a>00476         id2 = read_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#ge4dc606cc62e123eb9cf1ec842104615">EMAC_PHY_REG_IDR2</a>);
<a name="l00477"></a>00477 
<a name="l00478"></a>00478 <span class="preprocessor">#ifdef MCB_LPC_1768</span>
<a name="l00479"></a>00479 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (((id1 &lt;&lt; 16) | (id2 &amp; 0xFFF0)) == <a class="code" href="group___e_m_a_c___private___macros.html#g1eebe6bdf9d59c1fb352a590c97bc022">EMAC_DP83848C_ID</a>) {
<a name="l00480"></a>00480                 <span class="keywordflow">switch</span>(ulPHYMode){
<a name="l00481"></a>00481                 <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#g12c9de5c06859015df7f30eda601d046">EMAC_MODE_AUTO</a>:
<a name="l00482"></a>00482                         write_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g668453deab2030352349c9878f187689">EMAC_PHY_REG_BMCR</a>, <a class="code" href="group___e_m_a_c___private___macros.html#gdb8a057194926bb81e1aeea5fbc68d89">EMAC_PHY_AUTO_NEG</a>);
<a name="l00483"></a>00483 <span class="preprocessor">#elif defined(IAR_LPC_1768) </span><span class="comment">/* Use IAR LPC1768 KickStart board */</span>
<a name="l00484"></a>00484         <span class="keywordflow">if</span> (((id1 &lt;&lt; 16) | id2) == EMAC_KSZ8721BL_ID) {
<a name="l00485"></a>00485                 <span class="comment">/* Configure the PHY device */</span>
<a name="l00486"></a>00486                 <span class="keywordflow">switch</span>(ulPHYMode){
<a name="l00487"></a>00487                 <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#g12c9de5c06859015df7f30eda601d046">EMAC_MODE_AUTO</a>:
<a name="l00488"></a>00488                         <span class="comment">/* Use auto-negotiation about the link speed. */</span>
<a name="l00489"></a>00489                         write_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g668453deab2030352349c9878f187689">EMAC_PHY_REG_BMCR</a>, <a class="code" href="group___e_m_a_c___private___macros.html#gdb8a057194926bb81e1aeea5fbc68d89">EMAC_PHY_AUTO_NEG</a>);
<a name="l00490"></a>00490 <span class="comment">//                      write_PHY (EMAC_PHY_REG_BMCR, EMAC_PHY_BMCR_AN);</span>
<a name="l00491"></a>00491 <span class="preprocessor">#endif</span>
<a name="l00492"></a>00492 <span class="preprocessor"></span>                        <span class="comment">/* Wait to complete Auto_Negotiation */</span>
<a name="l00493"></a>00493                         <span class="keywordflow">for</span> (tout = <a class="code" href="group___e_m_a_c___private___macros.html#gc7f3564ded9d9f076b675010c8c73b0a">EMAC_PHY_RESP_TOUT</a>; tout; tout--) {
<a name="l00494"></a>00494                                 regv = read_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g2a8674b42b04e5ba80a0f545b8b27f5a">EMAC_PHY_REG_BMSR</a>);
<a name="l00495"></a>00495                                 <span class="keywordflow">if</span> (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#g705fb3760667eca6acef0dfb11e3eb61">EMAC_PHY_BMSR_AUTO_DONE</a>) {
<a name="l00496"></a>00496                                         <span class="comment">/* Auto-negotiation Complete. */</span>
<a name="l00497"></a>00497                                         <span class="keywordflow">break</span>;
<a name="l00498"></a>00498                                 }
<a name="l00499"></a>00499                                 <span class="keywordflow">if</span> (tout == 0){
<a name="l00500"></a>00500                                         <span class="comment">// Time out, return error</span>
<a name="l00501"></a>00501                                         <span class="keywordflow">return</span> (-1);
<a name="l00502"></a>00502                                 }
<a name="l00503"></a>00503                         }
<a name="l00504"></a>00504                         <span class="keywordflow">break</span>;
<a name="l00505"></a>00505                 <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#g20df377382f23ecca905dd8641e7b4d3">EMAC_MODE_10M_FULL</a>:
<a name="l00506"></a>00506                         <span class="comment">/* Connect at 10MBit full-duplex */</span>
<a name="l00507"></a>00507                         write_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g668453deab2030352349c9878f187689">EMAC_PHY_REG_BMCR</a>, <a class="code" href="group___e_m_a_c___private___macros.html#gd973c9c122c46365d4f90fbea2e4c47d">EMAC_PHY_FULLD_10M</a>);
<a name="l00508"></a>00508                         <span class="keywordflow">break</span>;
<a name="l00509"></a>00509                 <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#gf0e2ed1b1af2e4ce0f2edd1f8b716348">EMAC_MODE_10M_HALF</a>:
<a name="l00510"></a>00510                         <span class="comment">/* Connect at 10MBit half-duplex */</span>
<a name="l00511"></a>00511                         write_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g668453deab2030352349c9878f187689">EMAC_PHY_REG_BMCR</a>, <a class="code" href="group___e_m_a_c___private___macros.html#g263611707dc1a286fc7c53725b59d24e">EMAC_PHY_HALFD_10M</a>);
<a name="l00512"></a>00512                         <span class="keywordflow">break</span>;
<a name="l00513"></a>00513                 <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#g2ff79609ffdae0a7e8499b77ef0d4097">EMAC_MODE_100M_FULL</a>:
<a name="l00514"></a>00514                         <span class="comment">/* Connect at 100MBit full-duplex */</span>
<a name="l00515"></a>00515                         write_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g668453deab2030352349c9878f187689">EMAC_PHY_REG_BMCR</a>, <a class="code" href="group___e_m_a_c___private___macros.html#gcec88245001c0ee9efb56c581d982dc1">EMAC_PHY_FULLD_100M</a>);
<a name="l00516"></a>00516                         <span class="keywordflow">break</span>;
<a name="l00517"></a>00517                 <span class="keywordflow">case</span> <a class="code" href="group___e_m_a_c___public___macros.html#g726fabbfd9feaa6c2e06d535d96665d1">EMAC_MODE_100M_HALF</a>:
<a name="l00518"></a>00518                         <span class="comment">/* Connect at 100MBit half-duplex */</span>
<a name="l00519"></a>00519                         write_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g668453deab2030352349c9878f187689">EMAC_PHY_REG_BMCR</a>, <a class="code" href="group___e_m_a_c___private___macros.html#g4166a59b610b6c78d68e161f710238fd">EMAC_PHY_HALFD_100M</a>);
<a name="l00520"></a>00520                         <span class="keywordflow">break</span>;
<a name="l00521"></a>00521                 <span class="keywordflow">default</span>:
<a name="l00522"></a>00522                         <span class="comment">// un-supported</span>
<a name="l00523"></a>00523                         <span class="keywordflow">return</span> (-1);
<a name="l00524"></a>00524                 }
<a name="l00525"></a>00525         }
<a name="l00526"></a>00526         <span class="comment">// It's not correct module ID</span>
<a name="l00527"></a>00527         <span class="keywordflow">else</span> {
<a name="l00528"></a>00528                 <span class="keywordflow">return</span> (-1);
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530 
<a name="l00531"></a>00531         <span class="comment">// Update EMAC configuration with current PHY status</span>
<a name="l00532"></a>00532         <span class="keywordflow">if</span> (<a class="code" href="group___e_m_a_c___public___functions.html#g362d181dcc2f697c551f2698a64e4d16" title="Auto-Configures value for the EMAC configuration register to match with current PHY...">EMAC_UpdatePHYStatus</a>() &lt; 0){
<a name="l00533"></a>00533                 <span class="keywordflow">return</span> (-1);
<a name="l00534"></a>00534         }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536         <span class="comment">// Complete</span>
<a name="l00537"></a>00537         <span class="keywordflow">return</span> (0);
<a name="l00538"></a>00538 }
<a name="l00539"></a>00539 
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <span class="comment">/*********************************************************************/</span>
<a name="l00551"></a><a class="code" href="group___e_m_a_c___public___functions.html#g362d181dcc2f697c551f2698a64e4d16">00551</a> int32_t <a class="code" href="group___e_m_a_c___public___functions.html#g362d181dcc2f697c551f2698a64e4d16" title="Auto-Configures value for the EMAC configuration register to match with current PHY...">EMAC_UpdatePHYStatus</a>(<span class="keywordtype">void</span>)
<a name="l00552"></a>00552 {
<a name="l00553"></a>00553         int32_t regv, tout;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555         <span class="comment">/* Check the link status. */</span>
<a name="l00556"></a>00556 <span class="preprocessor">#ifdef MCB_LPC_1768</span>
<a name="l00557"></a>00557 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (tout = <a class="code" href="group___e_m_a_c___private___macros.html#gc7f3564ded9d9f076b675010c8c73b0a">EMAC_PHY_RESP_TOUT</a>; tout; tout--) {
<a name="l00558"></a>00558                 regv = read_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#gb81231cf870148e245035dc9f08ce098">EMAC_PHY_REG_STS</a>);
<a name="l00559"></a>00559                 <span class="keywordflow">if</span> (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#ge900e0c2eb89f503113b6fb21e5802ac">EMAC_PHY_SR_LINK</a>) {
<a name="l00560"></a>00560                         <span class="comment">/* Link is on. */</span>
<a name="l00561"></a>00561                         <span class="keywordflow">break</span>;
<a name="l00562"></a>00562                 }
<a name="l00563"></a>00563                 <span class="keywordflow">if</span> (tout == 0){
<a name="l00564"></a>00564                         <span class="comment">// time out</span>
<a name="l00565"></a>00565                         <span class="keywordflow">return</span> (-1);
<a name="l00566"></a>00566                 }
<a name="l00567"></a>00567         }
<a name="l00568"></a>00568         <span class="comment">/* Configure Full/Half Duplex mode. */</span>
<a name="l00569"></a>00569         <span class="keywordflow">if</span> (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#gddc6ea053559cb4315e1bcb7b5ba7a73">EMAC_PHY_SR_DUP</a>) {
<a name="l00570"></a>00570         <span class="comment">/* Full duplex is enabled. */</span>
<a name="l00571"></a>00571                         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MAC2    |= <a class="code" href="group___e_m_a_c___private___macros.html#gdde611f24c830f28cbaaabb358e9d985">EMAC_MAC2_FULL_DUP</a>;
<a name="l00572"></a>00572                         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;Command |= <a class="code" href="group___e_m_a_c___private___macros.html#g0528e680094183adb8c7b4fe6a06c4cb">EMAC_CR_FULL_DUP</a>;
<a name="l00573"></a>00573                         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IPGT     = <a class="code" href="group___e_m_a_c___private___macros.html#gb7bf3afef2412a77349711e2e88e0aa1">EMAC_IPGT_FULL_DUP</a>;
<a name="l00574"></a>00574         } <span class="keywordflow">else</span> {
<a name="l00575"></a>00575                 <span class="comment">/* Half duplex mode. */</span>
<a name="l00576"></a>00576                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IPGT = <a class="code" href="group___e_m_a_c___private___macros.html#gd4771025321fbd32b63ea62452759cb9">EMAC_IPGT_HALF_DUP</a>;
<a name="l00577"></a>00577         }
<a name="l00578"></a>00578         <span class="keywordflow">if</span> (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#g0613826cbb73f578c28df81726036103">EMAC_PHY_SR_SPEED</a>) {
<a name="l00579"></a>00579         <span class="comment">/* 10MBit mode. */</span>
<a name="l00580"></a>00580                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;SUPP = 0;
<a name="l00581"></a>00581         } <span class="keywordflow">else</span> {
<a name="l00582"></a>00582                 <span class="comment">/* 100MBit mode. */</span>
<a name="l00583"></a>00583                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;SUPP = <a class="code" href="group___e_m_a_c___private___macros.html#gd2ecdc63e97958e95d6e6ac7a98492b7">EMAC_SUPP_SPEED</a>;
<a name="l00584"></a>00584         }
<a name="l00585"></a>00585 <span class="preprocessor">#elif defined(IAR_LPC_1768)</span>
<a name="l00586"></a>00586 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (tout = <a class="code" href="group___e_m_a_c___private___macros.html#gc7f3564ded9d9f076b675010c8c73b0a">EMAC_PHY_RESP_TOUT</a>; tout; tout--) {
<a name="l00587"></a>00587                 regv = read_PHY (<a class="code" href="group___e_m_a_c___private___macros.html#g2a8674b42b04e5ba80a0f545b8b27f5a">EMAC_PHY_REG_BMSR</a>);
<a name="l00588"></a>00588                 <span class="keywordflow">if</span> (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#ga3c622875c53f67363dfefdf6dd7418a">EMAC_PHY_BMSR_LINK_STATUS</a>) {
<a name="l00589"></a>00589                         <span class="comment">/* Link is on. */</span>
<a name="l00590"></a>00590                         <span class="keywordflow">break</span>;
<a name="l00591"></a>00591                 }
<a name="l00592"></a>00592                 <span class="keywordflow">if</span> (tout == 0){
<a name="l00593"></a>00593                         <span class="comment">// time out</span>
<a name="l00594"></a>00594                         <span class="keywordflow">return</span> (-1);
<a name="l00595"></a>00595                 }
<a name="l00596"></a>00596         }
<a name="l00597"></a>00597 
<a name="l00598"></a>00598         <span class="comment">/* Configure Full/Half Duplex mode. */</span>
<a name="l00599"></a>00599         <span class="keywordflow">if</span> (regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#gc8c9e0931b22c907d4692bc655843808">EMAC_PHY_SR_FULL_DUP</a>) {
<a name="l00600"></a>00600                 <span class="comment">/* Full duplex is enabled. */</span>
<a name="l00601"></a>00601                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;MAC2    |= <a class="code" href="group___e_m_a_c___private___macros.html#gdde611f24c830f28cbaaabb358e9d985">EMAC_MAC2_FULL_DUP</a>;
<a name="l00602"></a>00602                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;Command |= <a class="code" href="group___e_m_a_c___private___macros.html#g0528e680094183adb8c7b4fe6a06c4cb">EMAC_CR_FULL_DUP</a>;
<a name="l00603"></a>00603                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IPGT     = <a class="code" href="group___e_m_a_c___private___macros.html#gb7bf3afef2412a77349711e2e88e0aa1">EMAC_IPGT_FULL_DUP</a>;
<a name="l00604"></a>00604         } <span class="keywordflow">else</span> {
<a name="l00605"></a>00605                 <span class="comment">/* Half duplex mode. */</span>
<a name="l00606"></a>00606                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IPGT = <a class="code" href="group___e_m_a_c___private___macros.html#gd4771025321fbd32b63ea62452759cb9">EMAC_IPGT_HALF_DUP</a>;
<a name="l00607"></a>00607         }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609         <span class="comment">/* Configure 100MBit/10MBit mode. */</span>
<a name="l00610"></a>00610         <span class="keywordflow">if</span> (!(regv &amp; <a class="code" href="group___e_m_a_c___private___macros.html#g658c866cfe4b1782af71e2864b65630f">EMAC_PHY_SR_100_SPEED</a>)) {
<a name="l00611"></a>00611                 <span class="comment">/* 10MBit mode. */</span>
<a name="l00612"></a>00612                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;SUPP = 0;
<a name="l00613"></a>00613         } <span class="keywordflow">else</span> {
<a name="l00614"></a>00614                 <span class="comment">/* 100MBit mode. */</span>
<a name="l00615"></a>00615                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;SUPP = <a class="code" href="group___e_m_a_c___private___macros.html#gd2ecdc63e97958e95d6e6ac7a98492b7">EMAC_SUPP_SPEED</a>;
<a name="l00616"></a>00616         }
<a name="l00617"></a>00617 <span class="preprocessor">#endif</span>
<a name="l00618"></a>00618 <span class="preprocessor"></span>        <span class="comment">// Complete</span>
<a name="l00619"></a>00619         <span class="keywordflow">return</span> (0);
<a name="l00620"></a>00620 }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 <span class="comment">/*********************************************************************/</span>
<a name="l00642"></a><a class="code" href="group___e_m_a_c___public___functions.html#gd636e7c2b7a47e9ebea226d13a9f88b3">00642</a> <span class="keywordtype">void</span> <a class="code" href="group___e_m_a_c___public___functions.html#gd636e7c2b7a47e9ebea226d13a9f88b3" title="Enable/Disable hash filter functionality for specified destination MAC address in...">EMAC_SetHashFilter</a>(uint8_t dstMAC_addr[], <a class="code" href="group___l_p_c___types___public___types.html#gc9a7e9a35d2513ec15c3b537aaa4fba1" title="Functional State Definition.">FunctionalState</a> NewState)
<a name="l00643"></a>00643 {
<a name="l00644"></a>00644         uint32_t *pReg;
<a name="l00645"></a>00645         uint32_t tmp;
<a name="l00646"></a>00646         int32_t crc;
<a name="l00647"></a>00647 
<a name="l00648"></a>00648         <span class="comment">// Calculate the CRC from the destination MAC address</span>
<a name="l00649"></a>00649         crc = emac_CRCCalc(dstMAC_addr, 6);
<a name="l00650"></a>00650         <span class="comment">// Extract the value from CRC to get index value for hash filter table</span>
<a name="l00651"></a>00651         crc = (crc &gt;&gt; 23) &amp; 0x3F;
<a name="l00652"></a>00652 
<a name="l00653"></a>00653         pReg = (crc &gt; 31) ? ((uint32_t *)&amp;<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;HashFilterH) \
<a name="l00654"></a>00654                                                                 : ((uint32_t *)&amp;<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;HashFilterL);
<a name="l00655"></a>00655         tmp = (crc &gt; 31) ? (crc - 32) : crc;
<a name="l00656"></a>00656         <span class="keywordflow">if</span> (NewState == <a class="code" href="group___l_p_c___types___public___types.html#ggc9a7e9a35d2513ec15c3b537aaa4fba17d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>) {
<a name="l00657"></a>00657                 (*pReg) |= (1UL &lt;&lt; tmp);
<a name="l00658"></a>00658         } <span class="keywordflow">else</span> {
<a name="l00659"></a>00659                 (*pReg) &amp;= ~(1UL &lt;&lt; tmp);
<a name="l00660"></a>00660         }
<a name="l00661"></a>00661         <span class="comment">// Enable Rx Filter</span>
<a name="l00662"></a>00662         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;Command &amp;= ~<a class="code" href="group___e_m_a_c___private___macros.html#g9e09677e261b091b3618ba266c559587">EMAC_CR_PASS_RX_FILT</a>;
<a name="l00663"></a>00663 }
<a name="l00664"></a>00664 
<a name="l00665"></a>00665 <span class="comment">/*********************************************************************/</span>
<a name="l00692"></a><a class="code" href="group___e_m_a_c___public___functions.html#g1630baff6eedc70bf2f8fb328c7006ac">00692</a> <span class="keywordtype">void</span> <a class="code" href="group___e_m_a_c___public___functions.html#g1630baff6eedc70bf2f8fb328c7006ac" title="Enable/Disable Filter mode for each specified type EMAC peripheral.">EMAC_SetFilterMode</a>(uint32_t ulFilterMode, <a class="code" href="group___l_p_c___types___public___types.html#gc9a7e9a35d2513ec15c3b537aaa4fba1" title="Functional State Definition.">FunctionalState</a> NewState)
<a name="l00693"></a>00693 {
<a name="l00694"></a>00694         <span class="keywordflow">if</span> (NewState == <a class="code" href="group___l_p_c___types___public___types.html#ggc9a7e9a35d2513ec15c3b537aaa4fba17d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>){
<a name="l00695"></a>00695                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxFilterCtrl |= ulFilterMode;
<a name="l00696"></a>00696         } <span class="keywordflow">else</span> {
<a name="l00697"></a>00697                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxFilterCtrl &amp;= ~ulFilterMode;
<a name="l00698"></a>00698         }
<a name="l00699"></a>00699 }
<a name="l00700"></a>00700 
<a name="l00701"></a>00701 <span class="comment">/*********************************************************************/</span>
<a name="l00718"></a><a class="code" href="group___e_m_a_c___public___functions.html#g34a8bca0e0b83ac18fce119535c102dc">00718</a> <a class="code" href="group___l_p_c___types___public___types.html#g89136caac2e14c55151f527ac02daaff" title="Flag Status and Interrupt Flag Status type definition.">FlagStatus</a> <a class="code" href="group___e_m_a_c___public___functions.html#g34a8bca0e0b83ac18fce119535c102dc" title="Get status of Wake On LAN Filter for each specified type in EMAC peripheral, clear...">EMAC_GetWoLStatus</a>(uint32_t ulWoLMode)
<a name="l00719"></a>00719 {
<a name="l00720"></a>00720         <span class="keywordflow">if</span> (<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxFilterWoLStatus &amp; ulWoLMode) {
<a name="l00721"></a>00721                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxFilterWoLClear = ulWoLMode;
<a name="l00722"></a>00722                 <span class="keywordflow">return</span> <a class="code" href="group___l_p_c___types___public___types.html#gg89136caac2e14c55151f527ac02daaffb44c8101cc294c074709ec1b14211792">SET</a>;
<a name="l00723"></a>00723         } <span class="keywordflow">else</span> {
<a name="l00724"></a>00724                 <span class="keywordflow">return</span> <a class="code" href="group___l_p_c___types___public___types.html#gg89136caac2e14c55151f527ac02daaff589b7d94a3d91d145720e2fed0eb3a05">RESET</a>;
<a name="l00725"></a>00725         }
<a name="l00726"></a>00726 }
<a name="l00727"></a>00727 
<a name="l00728"></a>00728 
<a name="l00729"></a>00729 <span class="comment">/*********************************************************************/</span>
<a name="l00737"></a><a class="code" href="group___e_m_a_c___public___functions.html#g8fc32da8e4f741a7806fa5639033675a">00737</a> <span class="keywordtype">void</span> <a class="code" href="group___e_m_a_c___public___functions.html#g8fc32da8e4f741a7806fa5639033675a" title="Write data to Tx packet data buffer at current index due to TxProduceIndex.">EMAC_WritePacketBuffer</a>(<a class="code" href="struct_e_m_a_c___p_a_c_k_e_t_b_u_f___type.html" title="TX Data Buffer structure definition.">EMAC_PACKETBUF_Type</a> *pDataStruct)
<a name="l00738"></a>00738 {
<a name="l00739"></a>00739         uint32_t idx,len;
<a name="l00740"></a>00740         uint32_t *sp,*dp;
<a name="l00741"></a>00741 
<a name="l00742"></a>00742         idx = <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;TxProduceIndex;
<a name="l00743"></a>00743         sp  = (uint32_t *)pDataStruct-&gt;<a class="code" href="struct_e_m_a_c___p_a_c_k_e_t_b_u_f___type.html#ac010861152334310b62febf4f7e3fa6">pbDataBuf</a>;
<a name="l00744"></a>00744         dp  = (uint32_t *)Tx_Desc[idx].Packet;
<a name="l00745"></a>00745         <span class="comment">/* Copy frame data to EMAC packet buffers. */</span>
<a name="l00746"></a>00746         <span class="keywordflow">for</span> (len = (pDataStruct-&gt;<a class="code" href="struct_e_m_a_c___p_a_c_k_e_t_b_u_f___type.html#87e6e87d8d237b7c2093a193c0f50a11">ulDataLen</a> + 3) &gt;&gt; 2; len; len--) {
<a name="l00747"></a>00747                 *dp++ = *sp++;
<a name="l00748"></a>00748         }
<a name="l00749"></a>00749         Tx_Desc[idx].Ctrl = (pDataStruct-&gt;<a class="code" href="struct_e_m_a_c___p_a_c_k_e_t_b_u_f___type.html#87e6e87d8d237b7c2093a193c0f50a11">ulDataLen</a> - 1) | (<a class="code" href="group___e_m_a_c___private___macros.html#g75fdd56cd6e79e142a18793ad139c150">EMAC_TCTRL_INT</a> | <a class="code" href="group___e_m_a_c___private___macros.html#gfc549894d17750b29c793e0f5f8b0e24">EMAC_TCTRL_LAST</a>);
<a name="l00750"></a>00750 }
<a name="l00751"></a>00751 
<a name="l00752"></a>00752 <span class="comment">/*********************************************************************/</span>
<a name="l00760"></a><a class="code" href="group___e_m_a_c___public___functions.html#gadcaada06e8146cf923866b5a4858724">00760</a> <span class="keywordtype">void</span> <a class="code" href="group___e_m_a_c___public___functions.html#gadcaada06e8146cf923866b5a4858724" title="Read data from Rx packet data buffer at current index due to RxConsumeIndex.">EMAC_ReadPacketBuffer</a>(<a class="code" href="struct_e_m_a_c___p_a_c_k_e_t_b_u_f___type.html" title="TX Data Buffer structure definition.">EMAC_PACKETBUF_Type</a> *pDataStruct)
<a name="l00761"></a>00761 {
<a name="l00762"></a>00762         uint32_t idx, len;
<a name="l00763"></a>00763         uint32_t *dp, *sp;
<a name="l00764"></a>00764 
<a name="l00765"></a>00765         idx = <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxConsumeIndex;
<a name="l00766"></a>00766         dp = (uint32_t *)pDataStruct-&gt;<a class="code" href="struct_e_m_a_c___p_a_c_k_e_t_b_u_f___type.html#ac010861152334310b62febf4f7e3fa6">pbDataBuf</a>;
<a name="l00767"></a>00767         sp = (uint32_t *)Rx_Desc[idx].<a class="code" href="struct_r_x___desc.html#f068a5f8f80955f4fd404b2d32db46c3">Packet</a>;
<a name="l00768"></a>00768 
<a name="l00769"></a>00769         <span class="keywordflow">if</span> (pDataStruct-&gt;<a class="code" href="struct_e_m_a_c___p_a_c_k_e_t_b_u_f___type.html#ac010861152334310b62febf4f7e3fa6">pbDataBuf</a> != <a class="code" href="group___l_p_c___types___public___macros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00770"></a>00770                 <span class="keywordflow">for</span> (len = (pDataStruct-&gt;<a class="code" href="struct_e_m_a_c___p_a_c_k_e_t_b_u_f___type.html#87e6e87d8d237b7c2093a193c0f50a11">ulDataLen</a> + 3) &gt;&gt; 2; len; len--) {
<a name="l00771"></a>00771                         *dp++ = *sp++;
<a name="l00772"></a>00772                 }
<a name="l00773"></a>00773         }
<a name="l00774"></a>00774 }
<a name="l00775"></a>00775 
<a name="l00776"></a>00776 <span class="comment">/*********************************************************************/</span>
<a name="l00794"></a><a class="code" href="group___e_m_a_c___public___functions.html#gde86e1c12cf6678f85aac23af5b466d6">00794</a> <span class="keywordtype">void</span> <a class="code" href="group___e_m_a_c___public___functions.html#gde86e1c12cf6678f85aac23af5b466d6" title="Enable/Disable interrupt for each type in EMAC.">EMAC_IntCmd</a>(uint32_t ulIntType, <a class="code" href="group___l_p_c___types___public___types.html#gc9a7e9a35d2513ec15c3b537aaa4fba1" title="Functional State Definition.">FunctionalState</a> NewState)
<a name="l00795"></a>00795 {
<a name="l00796"></a>00796         <span class="keywordflow">if</span> (NewState == <a class="code" href="group___l_p_c___types___public___types.html#ggc9a7e9a35d2513ec15c3b537aaa4fba17d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>) {
<a name="l00797"></a>00797                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IntEnable |= ulIntType;
<a name="l00798"></a>00798         } <span class="keywordflow">else</span> {
<a name="l00799"></a>00799                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IntEnable &amp;= ~(ulIntType);
<a name="l00800"></a>00800         }
<a name="l00801"></a>00801 }
<a name="l00802"></a>00802 
<a name="l00803"></a>00803 <span class="comment">/*********************************************************************/</span>
<a name="l00820"></a><a class="code" href="group___e_m_a_c___public___functions.html#gea8abd458e53a9494a8deaca0289e051">00820</a> <a class="code" href="group___l_p_c___types___public___types.html#gb7d263072f745b4f3913fb0afc434c4e">IntStatus</a> <a class="code" href="group___e_m_a_c___public___functions.html#gea8abd458e53a9494a8deaca0289e051" title="Check whether if specified interrupt flag is set or not for each interrupt type in...">EMAC_IntGetStatus</a>(uint32_t ulIntType)
<a name="l00821"></a>00821 {
<a name="l00822"></a>00822         <span class="keywordflow">if</span> (<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IntStatus &amp; ulIntType) {
<a name="l00823"></a>00823                 <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;IntClear = ulIntType;
<a name="l00824"></a>00824                 <span class="keywordflow">return</span> <a class="code" href="group___l_p_c___types___public___types.html#gg89136caac2e14c55151f527ac02daaffb44c8101cc294c074709ec1b14211792">SET</a>;
<a name="l00825"></a>00825         } <span class="keywordflow">else</span> {
<a name="l00826"></a>00826                 <span class="keywordflow">return</span> <a class="code" href="group___l_p_c___types___public___types.html#gg89136caac2e14c55151f527ac02daaff589b7d94a3d91d145720e2fed0eb3a05">RESET</a>;
<a name="l00827"></a>00827         }
<a name="l00828"></a>00828 }
<a name="l00829"></a>00829 
<a name="l00830"></a>00830 
<a name="l00831"></a>00831 <span class="comment">/*********************************************************************/</span>
<a name="l00841"></a><a class="code" href="group___e_m_a_c___public___functions.html#gb72129f5498cfae3f71e2f7b813c09ed">00841</a> <a class="code" href="group___l_p_c___types___public___types.html#g39db6982619d623273fad8a383489309" title="Boolean Type definition.">Bool</a> <a class="code" href="group___e_m_a_c___public___functions.html#gb72129f5498cfae3f71e2f7b813c09ed" title="Check whether if the current RxConsumeIndex is not equal to the current RxProduceIndex...">EMAC_CheckReceiveIndex</a>(<span class="keywordtype">void</span>)
<a name="l00842"></a>00842 {
<a name="l00843"></a>00843         <span class="keywordflow">if</span> (<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxConsumeIndex != <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxProduceIndex) {
<a name="l00844"></a>00844                 <span class="keywordflow">return</span> <a class="code" href="group___l_p_c___types___public___types.html#gg39db6982619d623273fad8a383489309a82764c3079aea4e60c80e45befbb839">TRUE</a>;
<a name="l00845"></a>00845         } <span class="keywordflow">else</span> {
<a name="l00846"></a>00846                 <span class="keywordflow">return</span> <a class="code" href="group___l_p_c___types___public___types.html#gg39db6982619d623273fad8a383489309a1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00847"></a>00847         }
<a name="l00848"></a>00848 }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 
<a name="l00851"></a>00851 <span class="comment">/*********************************************************************/</span>
<a name="l00861"></a><a class="code" href="group___e_m_a_c___public___functions.html#g1283c688522f56d206c045e4c752b588">00861</a> <a class="code" href="group___l_p_c___types___public___types.html#g39db6982619d623273fad8a383489309" title="Boolean Type definition.">Bool</a> <a class="code" href="group___e_m_a_c___public___functions.html#g1283c688522f56d206c045e4c752b588" title="Check whether if the current TxProduceIndex is not equal to the current RxProduceIndex...">EMAC_CheckTransmitIndex</a>(<span class="keywordtype">void</span>)
<a name="l00862"></a>00862 {
<a name="l00863"></a>00863         uint32_t tmp = <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;TxConsumeIndex -1;
<a name="l00864"></a>00864         <span class="keywordflow">if</span> (<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;TxProduceIndex == tmp) {
<a name="l00865"></a>00865                 <span class="keywordflow">return</span> <a class="code" href="group___l_p_c___types___public___types.html#gg39db6982619d623273fad8a383489309a1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00866"></a>00866         } <span class="keywordflow">else</span> {
<a name="l00867"></a>00867                 <span class="keywordflow">return</span> <a class="code" href="group___l_p_c___types___public___types.html#gg39db6982619d623273fad8a383489309a82764c3079aea4e60c80e45befbb839">TRUE</a>;
<a name="l00868"></a>00868         }
<a name="l00869"></a>00869 }
<a name="l00870"></a>00870 
<a name="l00871"></a>00871 
<a name="l00872"></a>00872 <span class="comment">/*********************************************************************/</span>
<a name="l00891"></a><a class="code" href="group___e_m_a_c___public___functions.html#g8c71f79c208695c4647e3e77cae4e76d">00891</a> <a class="code" href="group___l_p_c___types___public___types.html#g89136caac2e14c55151f527ac02daaff" title="Flag Status and Interrupt Flag Status type definition.">FlagStatus</a> <a class="code" href="group___e_m_a_c___public___functions.html#g8c71f79c208695c4647e3e77cae4e76d" title="Get current status value of receive data (due to RxConsumeIndex).">EMAC_CheckReceiveDataStatus</a>(uint32_t ulRxStatType)
<a name="l00892"></a>00892 {
<a name="l00893"></a>00893         uint32_t idx;
<a name="l00894"></a>00894         idx = <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxConsumeIndex;
<a name="l00895"></a>00895         <span class="keywordflow">return</span> (((Rx_Stat[idx].Info) &amp; ulRxStatType) ? <a class="code" href="group___l_p_c___types___public___types.html#gg89136caac2e14c55151f527ac02daaffb44c8101cc294c074709ec1b14211792">SET</a> : <a class="code" href="group___l_p_c___types___public___types.html#gg89136caac2e14c55151f527ac02daaff589b7d94a3d91d145720e2fed0eb3a05">RESET</a>);
<a name="l00896"></a>00896 }
<a name="l00897"></a>00897 
<a name="l00898"></a>00898 
<a name="l00899"></a>00899 <span class="comment">/*********************************************************************/</span>
<a name="l00905"></a><a class="code" href="group___e_m_a_c___public___functions.html#g71a1b28be526c2cbe4f5993a656f2fba">00905</a> uint32_t <a class="code" href="group___e_m_a_c___public___functions.html#g71a1b28be526c2cbe4f5993a656f2fba" title="Get size of current Received data in received buffer (due to RxConsumeIndex).">EMAC_GetReceiveDataSize</a>(<span class="keywordtype">void</span>)
<a name="l00906"></a>00906 {
<a name="l00907"></a>00907         uint32_t idx;
<a name="l00908"></a>00908         idx =<a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxConsumeIndex;
<a name="l00909"></a>00909         <span class="keywordflow">return</span> ((Rx_Stat[idx].Info) &amp; <a class="code" href="group___e_m_a_c___private___macros.html#gb41ca772c766f8e9ae7f4496c9159266">EMAC_RINFO_SIZE</a>);
<a name="l00910"></a>00910 }
<a name="l00911"></a>00911 
<a name="l00912"></a>00912 <span class="comment">/*********************************************************************/</span>
<a name="l00919"></a><a class="code" href="group___e_m_a_c___public___functions.html#gd22d992dd541c975eab6ef42625007b1">00919</a> <span class="keywordtype">void</span> <a class="code" href="group___e_m_a_c___public___functions.html#gd22d992dd541c975eab6ef42625007b1" title="Increase the RxConsumeIndex (after reading the Receive buffer to release the Receive...">EMAC_UpdateRxConsumeIndex</a>(<span class="keywordtype">void</span>)
<a name="l00920"></a>00920 {
<a name="l00921"></a>00921         <span class="comment">// Get current Rx consume index</span>
<a name="l00922"></a>00922         uint32_t idx = <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxConsumeIndex;
<a name="l00923"></a>00923 
<a name="l00924"></a>00924         <span class="comment">/* Release frame from EMAC buffer */</span>
<a name="l00925"></a>00925         <span class="keywordflow">if</span> (++idx == EMAC_NUM_RX_FRAG) idx = 0;
<a name="l00926"></a>00926         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;RxConsumeIndex = idx;
<a name="l00927"></a>00927 }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929 <span class="comment">/*********************************************************************/</span>
<a name="l00936"></a><a class="code" href="group___e_m_a_c___public___functions.html#gbe9a248525e20f3776979ff07d832ac8">00936</a> <span class="keywordtype">void</span> <a class="code" href="group___e_m_a_c___public___functions.html#gbe9a248525e20f3776979ff07d832ac8" title="Increase the TxProduceIndex (after writting to the Transmit buffer to enable the...">EMAC_UpdateTxProduceIndex</a>(<span class="keywordtype">void</span>)
<a name="l00937"></a>00937 {
<a name="l00938"></a>00938         <span class="comment">// Get current Tx produce index</span>
<a name="l00939"></a>00939         uint32_t idx = <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;TxProduceIndex;
<a name="l00940"></a>00940 
<a name="l00941"></a>00941         <span class="comment">/* Start frame transmission */</span>
<a name="l00942"></a>00942         <span class="keywordflow">if</span> (++idx == <a class="code" href="group___e_m_a_c___private___macros.html#g935cd0225e96d031ea7f484d614f10c6">EMAC_NUM_TX_FRAG</a>) idx = 0;
<a name="l00943"></a>00943         <a class="code" href="group___l_p_c17xx___system.html#g75e74c74e4b52e53d56b9e13be2bc5b5">LPC_EMAC</a>-&gt;TxProduceIndex = idx;
<a name="l00944"></a>00944 }
<a name="l00945"></a>00945 
<a name="l00946"></a>00946 
<a name="l00951"></a>00951 <span class="preprocessor">#endif </span><span class="comment">/* _EMAC */</span>
<a name="l00952"></a>00952 
<a name="l00957"></a>00957 <span class="comment">/* --------------------------------- End Of File ------------------------------ */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Jun 7 14:58:56 2011 for LPC1700CMSIS Standard Peripheral Firmware Library Manual by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
