<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LPC1700CMSIS Standard Peripheral Firmware Library Manual: C:/nxpdrv/LPC1700CMSIS/Examples/EMAC/Easy_Web/tcpip.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>C:/nxpdrv/LPC1700CMSIS/Examples/EMAC/Easy_Web/tcpip.h</h1><a href="tcpip_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/******************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *****                                                        *****</span>
<a name="l00003"></a>00003 <span class="comment"> *****  Name: tcpip.h                                         *****</span>
<a name="l00004"></a>00004 <span class="comment"> *****  Ver.: 1.0                                             *****</span>
<a name="l00005"></a>00005 <span class="comment"> *****  Date: 07/05/2001                                      *****</span>
<a name="l00006"></a>00006 <span class="comment"> *****  Auth: Andreas Dannenberg                              *****</span>
<a name="l00007"></a>00007 <span class="comment"> *****        HTWK Leipzig                                    *****</span>
<a name="l00008"></a>00008 <span class="comment"> *****        university of applied sciences                  *****</span>
<a name="l00009"></a>00009 <span class="comment"> *****        Germany                                         *****</span>
<a name="l00010"></a>00010 <span class="comment"> *****  Func: header-file for tcpip.c                         *****</span>
<a name="l00011"></a>00011 <span class="comment"> *****                                                        *****</span>
<a name="l00012"></a>00012 <span class="comment"> ******************************************************************/</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#ifndef __TCPIP_H</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor">#define __TCPIP_H</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00017"></a>00017 <span class="comment">// easyWEB-stack definitions</span>
<a name="l00018"></a><a class="code" href="tcpip_8h.html#314b8b1509fa2479b6e7e727c746b1ba">00018</a> <span class="preprocessor">#define MYIP_1               192                 // our internet protocol (IP) address</span>
<a name="l00019"></a><a class="code" href="tcpip_8h.html#eea8cae416884fbd2cccb5f77847b4f5">00019</a> <span class="preprocessor"></span><span class="preprocessor">#define MYIP_2               168</span>
<a name="l00020"></a><a class="code" href="tcpip_8h.html#216d82e83931dc57a7dd266bc4710b11">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define MYIP_3               0</span>
<a name="l00021"></a><a class="code" href="tcpip_8h.html#32b76d3842c75612db17d8447af73e50">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define MYIP_4               100</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a><a class="code" href="tcpip_8h.html#a62261639fc2ca56065fe7ba7a723b19">00023</a> <span class="preprocessor">#define SUBMASK_1            255                 // subnet mask</span>
<a name="l00024"></a><a class="code" href="tcpip_8h.html#94c6f60ffa3a9125f57e905984bb004b">00024</a> <span class="preprocessor"></span><span class="preprocessor">#define SUBMASK_2            255</span>
<a name="l00025"></a><a class="code" href="tcpip_8h.html#e73a035cb52fc49271110b2619879144">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define SUBMASK_3            255</span>
<a name="l00026"></a><a class="code" href="tcpip_8h.html#a0c0b7827c606c156b5a46f9da9b9abd">00026</a> <span class="preprocessor"></span><span class="preprocessor">#define SUBMASK_4            0</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00028"></a><a class="code" href="tcpip_8h.html#ffc624fd13af8a29abbb839105d17bd7">00028</a> <span class="preprocessor">#define GWIP_1               192                 // standard gateway (used if remote</span>
<a name="l00029"></a><a class="code" href="tcpip_8h.html#c3da5f77f50de1aebf8d7a97f5027aa5">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define GWIP_2               168                 // IP is no part of our subnet)</span>
<a name="l00030"></a><a class="code" href="tcpip_8h.html#0262b20db4bef5f02cf8aeeeed9737c3">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define GWIP_3               0</span>
<a name="l00031"></a><a class="code" href="tcpip_8h.html#00c8d0d97d17a78c7f214ab445222c8b">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define GWIP_4               254</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a><a class="code" href="tcpip_8h.html#b28fa84742de00ea3342319de160ff37">00033</a> <span class="preprocessor">#define RETRY_TIMEOUT        8                   // wait max. 8 x 262ms for an ACK (about 2 sec.)</span>
<a name="l00034"></a><a class="code" href="tcpip_8h.html#84decda795f6bed0026dee441fdb301a">00034</a> <span class="preprocessor"></span><span class="preprocessor">#define FIN_TIMEOUT          2                   // max. time to wait for an ACK of a FIN</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>                                                 <span class="comment">// before closing TCP state-machine (about 0.5 s)</span>
<a name="l00036"></a><a class="code" href="tcpip_8h.html#c9c4c998ac10fe4e2a57295f2199ebb0">00036</a> <span class="preprocessor">#define MAX_RETRYS           4                   // nr. of resendings before reset conn.</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>                                                 <span class="comment">// total nr. of transmissions = MAX_RETRYS + 1</span>
<a name="l00038"></a>00038 
<a name="l00039"></a><a class="code" href="tcpip_8h.html#2f24f8b939928f6a8e273c70bf765fdf">00039</a> <span class="preprocessor">#define MAX_TCP_TX_DATA_SIZE 512                 // max. outgoing TCP data size (even!)</span>
<a name="l00040"></a><a class="code" href="tcpip_8h.html#6ee5ff4d45449a0bb5c2ab3ca75b9de9">00040</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_TCP_RX_DATA_SIZE 256                 // max. incoming TCP data size (even!)</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span>                                                 <span class="comment">// (increasing the buffer-size dramatically</span>
<a name="l00042"></a>00042                                                  <span class="comment">// increases the transfer-speed!)</span>
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="tcpip_8h.html#07fa3b3206b1edb807bd6a8b8faef812">00044</a> <span class="preprocessor">#define MAX_ETH_TX_DATA_SIZE 60                  // 2nd buffer, used for ARP, ICMP, TCP (even!)</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span>                                                 <span class="comment">// enough to echo 32 byte via ICMP</span>
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="tcpip_8h.html#a9b73542f958f4edfe5ebea8efe0ff8b">00047</a> <span class="preprocessor">#define DEFAULT_TTL          64                  // Time To Live sent with packets</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00049"></a>00049 <span class="comment">// Ethernet network layer definitions</span>
<a name="l00050"></a><a class="code" href="tcpip_8h.html#f9bdf30fbf113e3f8c835413ee5c9b76">00050</a> <span class="preprocessor">#define ETH_DA_OFS           0                   // Destination MAC address (48 Bit)</span>
<a name="l00051"></a><a class="code" href="tcpip_8h.html#d7079f8f5c8b5d65fc23490be4c97eb7">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define ETH_SA_OFS           6                   // Source MAC address (48 Bit)</span>
<a name="l00052"></a><a class="code" href="tcpip_8h.html#6ae62d7a39aa2bd167949b6108ab5065">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define ETH_TYPE_OFS         12                  // Type field (16 Bit)</span>
<a name="l00053"></a><a class="code" href="tcpip_8h.html#ca5d43d97812ad25ce8d76375f333fa4">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define ETH_DATA_OFS         14                  // Frame Data</span>
<a name="l00054"></a><a class="code" href="tcpip_8h.html#3106835123967aabc7080e171ce08c5d">00054</a> <span class="preprocessor"></span><span class="preprocessor">#define ETH_HEADER_SIZE      14</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="tcpip_8h.html#834989e3157808f71f2aaf5f76dae9a8">00056</a> <span class="preprocessor">#define FRAME_ARP            0x0806              // frame types (stored in Type/Length field)</span>
<a name="l00057"></a><a class="code" href="tcpip_8h.html#9f333e8eb720804c8f37c07d472f8130">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define FRAME_IP             0x0800</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span>
<a name="l00059"></a>00059 <span class="comment">// IPv4 layer definitions</span>
<a name="l00060"></a><a class="code" href="tcpip_8h.html#84eda93572084bebb8fb3f1216fa05aa">00060</a> <span class="preprocessor">#define IP_VER_IHL_TOS_OFS   ETH_DATA_OFS + 0    // Version, Header Length, Type of Service</span>
<a name="l00061"></a><a class="code" href="tcpip_8h.html#00ccd6b67699e9eeac685cd2c5b752f3">00061</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_TOTAL_LENGTH_OFS  ETH_DATA_OFS + 2    // IP Frame's Total Length</span>
<a name="l00062"></a><a class="code" href="tcpip_8h.html#f615529c554cc32804829b81740758c0">00062</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_IDENT_OFS         ETH_DATA_OFS + 4    // Identifying Value</span>
<a name="l00063"></a><a class="code" href="tcpip_8h.html#5817d332ec0199044ae6246c6d313a8d">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_FLAGS_FRAG_OFS    ETH_DATA_OFS + 6    // Flags and Fragment Offset</span>
<a name="l00064"></a><a class="code" href="tcpip_8h.html#ad32adc18a6e9b4e4fa913b8faeae062">00064</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_TTL_PROT_OFS      ETH_DATA_OFS + 8    // Frame's Time to Live, Protocol</span>
<a name="l00065"></a><a class="code" href="tcpip_8h.html#ec7c18dd84bd74e1c555736f419d75f2">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_HEAD_CHKSUM_OFS   ETH_DATA_OFS + 10   // IP Frame's Header Checksum</span>
<a name="l00066"></a><a class="code" href="tcpip_8h.html#0dc830b6c39a099d7855c9672bf8d2b0">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_SOURCE_OFS        ETH_DATA_OFS + 12   // Source Address (32 Bit)</span>
<a name="l00067"></a><a class="code" href="tcpip_8h.html#3939d94914d64c487fe29bd9cdc7034a">00067</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_DESTINATION_OFS   ETH_DATA_OFS + 16   // Destination Address (32 Bit)</span>
<a name="l00068"></a><a class="code" href="tcpip_8h.html#ce34fe9452c15cd1db7c38dc6406c2e6">00068</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_DATA_OFS          ETH_DATA_OFS + 20   // Frame Data (if no options)</span>
<a name="l00069"></a><a class="code" href="tcpip_8h.html#21bc1a47f469b35f87dc62b1782a207d">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_HEADER_SIZE       20                  // w/o options</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span>
<a name="l00071"></a><a class="code" href="tcpip_8h.html#c2a983db03040d942b509a8c07a598db">00071</a> <span class="preprocessor">#define IP_VER_IHL           0x4500              // IPv4, Header Length = 5x32 bit</span>
<a name="l00072"></a><a class="code" href="tcpip_8h.html#76211d9a68bed3049d52def26cb3cc23">00072</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_TOS_D             0x0010              // TOS low delay</span>
<a name="l00073"></a><a class="code" href="tcpip_8h.html#49530585429d8b2ba26500f37f840d7c">00073</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_TOS_T             0x0008              // TOS high throughput</span>
<a name="l00074"></a><a class="code" href="tcpip_8h.html#da9685fe4fbb7a4d8ad58ba393a58dc5">00074</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_TOS_R             0x0004              // TOS high reliability</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span>
<a name="l00076"></a><a class="code" href="tcpip_8h.html#af33a1c25c9ff85d6b4ed8b58bda328c">00076</a> <span class="preprocessor">#define IP_FLAG_DONTFRAG     0x4000              // don't fragment IP frame</span>
<a name="l00077"></a><a class="code" href="tcpip_8h.html#faa97c06ce96598252cde5e5441d89ac">00077</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_FLAG_MOREFRAG     0x2000              // more fragments available</span>
<a name="l00078"></a><a class="code" href="tcpip_8h.html#765993b7793d39612d1195be6d5885ab">00078</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_FRAGOFS_MASK      0x1FFF              // indicates where this fragment belongs</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span>
<a name="l00080"></a><a class="code" href="tcpip_8h.html#e8e620e2c4b1bf0461c3652238c9fccd">00080</a> <span class="preprocessor">#define PROT_ICMP            1                   // Internet Control Message Protocol</span>
<a name="l00081"></a><a class="code" href="tcpip_8h.html#56ceccbbb11411d125bf8aaf48fcac21">00081</a> <span class="preprocessor"></span><span class="preprocessor">#define PROT_TCP             6                   // Transmission Control Protocol</span>
<a name="l00082"></a><a class="code" href="tcpip_8h.html#fb5ebfaff9a32a76648ad89c0ab05a11">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define PROT_UDP             17                  // User Datagram Protocol</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span>
<a name="l00084"></a>00084 <span class="comment">// ARP definitions</span>
<a name="l00085"></a><a class="code" href="tcpip_8h.html#1f30e1637b7fb82ddc343ce85b40b049">00085</a> <span class="preprocessor">#define ARP_HARDW_OFS        ETH_DATA_OFS + 0    // Hardware address type</span>
<a name="l00086"></a><a class="code" href="tcpip_8h.html#5358f528383251ba8ebee33db9fa391c">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define ARP_PROT_OFS         ETH_DATA_OFS + 2    // Protocol</span>
<a name="l00087"></a><a class="code" href="tcpip_8h.html#1f396fa6101c6f5948238e47a8771d16">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define ARP_HLEN_PLEN_OFS    ETH_DATA_OFS + 4    // byte length of each hardw. / prot. address</span>
<a name="l00088"></a><a class="code" href="tcpip_8h.html#b4942fabefee66571c117ec0975ed8ee">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define ARP_OPCODE_OFS       ETH_DATA_OFS + 6    // Opcode</span>
<a name="l00089"></a><a class="code" href="tcpip_8h.html#436da4c8938b6c012b63e0abbeeb0225">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define ARP_SENDER_HA_OFS    ETH_DATA_OFS + 8    // Hardw. address of sender of this packet</span>
<a name="l00090"></a><a class="code" href="tcpip_8h.html#bdcab06a56eb367ba51fe8c1aa6259fb">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define ARP_SENDER_IP_OFS    ETH_DATA_OFS + 14   // IP address of sender</span>
<a name="l00091"></a><a class="code" href="tcpip_8h.html#7ca8be15f128dbda5d3f4919456b9e73">00091</a> <span class="preprocessor"></span><span class="preprocessor">#define ARP_TARGET_HA_OFS    ETH_DATA_OFS + 18   // Hardw. address of target of this packet</span>
<a name="l00092"></a><a class="code" href="tcpip_8h.html#1026140ff80c2aa2c76134f242e14df6">00092</a> <span class="preprocessor"></span><span class="preprocessor">#define ARP_TARGET_IP_OFS    ETH_DATA_OFS + 24   // IP address of target</span>
<a name="l00093"></a><a class="code" href="tcpip_8h.html#11e6360716e0fde98dc92aeffeaac828">00093</a> <span class="preprocessor"></span><span class="preprocessor">#define ARP_FRAME_SIZE       28</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>
<a name="l00095"></a><a class="code" href="tcpip_8h.html#6f270e06a252454000b6b375d0b72996">00095</a> <span class="preprocessor">#define HARDW_ETH10          1                   // hardware-type 10Mbps Ethernet</span>
<a name="l00096"></a><a class="code" href="tcpip_8h.html#6e97efe93cb74227047eb1e5dbcd82b2">00096</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_HLEN_PLEN         0x0604              // MAC = 6 byte long, IP = 4 byte long</span>
<a name="l00097"></a><a class="code" href="tcpip_8h.html#4b31d5399d2d750d1575bcdd324ac518">00097</a> <span class="preprocessor"></span><span class="preprocessor">#define OP_ARP_REQUEST       1                   // operations for ARP-frames</span>
<a name="l00098"></a><a class="code" href="tcpip_8h.html#d7d755d34fc7ee88e79bc67a5dadf896">00098</a> <span class="preprocessor"></span><span class="preprocessor">#define OP_ARP_ANSWER        2</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span>
<a name="l00100"></a>00100 <span class="comment">// ICMP definitions</span>
<a name="l00101"></a><a class="code" href="tcpip_8h.html#2ccf80ae5eef032cc1b1ff20d20e2b61">00101</a> <span class="preprocessor">#define ICMP_TYPE_CODE_OFS   IP_DATA_OFS + 0     // type of message</span>
<a name="l00102"></a><a class="code" href="tcpip_8h.html#9913340104b339d612e7c0dfdb9525bf">00102</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP_CHKSUM_OFS      IP_DATA_OFS + 2     // checksum of ICMP-message (16 bit)</span>
<a name="l00103"></a><a class="code" href="tcpip_8h.html#66c0c66cb583f421075594c784516ac1">00103</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP_DATA_OFS        IP_DATA_OFS + 4</span>
<a name="l00104"></a><a class="code" href="tcpip_8h.html#f38a94f3f97e5c0b22a53e961b0fcb3a">00104</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP_HEADER_SIZE     4</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span>
<a name="l00106"></a><a class="code" href="tcpip_8h.html#d58231410d58e34b455328b888a9e73c">00106</a> <span class="preprocessor">#define ICMP_ECHO            8                   // message is an echo request</span>
<a name="l00107"></a><a class="code" href="tcpip_8h.html#5c5b1834e497f53ad0ef947bbe9777fa">00107</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP_ECHO_REPLY      0                   // message is an echo reply</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>
<a name="l00109"></a>00109 <span class="comment">// TCP layer definitions</span>
<a name="l00110"></a><a class="code" href="tcpip_8h.html#de40027d1ce5254700ce42f80aca7322">00110</a> <span class="preprocessor">#define TCP_SRCPORT_OFS      IP_DATA_OFS + 0     // Source Port (16 bit)</span>
<a name="l00111"></a><a class="code" href="tcpip_8h.html#8cda56a74f0240775ba399f94e068b97">00111</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_DESTPORT_OFS     IP_DATA_OFS + 2     // Destination Port (16 bit)</span>
<a name="l00112"></a><a class="code" href="tcpip_8h.html#fa39b59173e2ed2f0e0be7bef1f3e13f">00112</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_SEQNR_OFS        IP_DATA_OFS + 4     // Sequence Number (32 bit)</span>
<a name="l00113"></a><a class="code" href="tcpip_8h.html#78dfb89033d61a09746c45fea62ea08d">00113</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_ACKNR_OFS        IP_DATA_OFS + 8     // Acknowledge Number (32 bit)</span>
<a name="l00114"></a><a class="code" href="tcpip_8h.html#3bd1ebdeed72b414b03441ddef6c5672">00114</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_DATA_CODE_OFS    IP_DATA_OFS + 12    // Data Offset and Control Bits (16 bit)</span>
<a name="l00115"></a><a class="code" href="tcpip_8h.html#b71ec493b739e6c555f22a96a008df87">00115</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_WINDOW_OFS       IP_DATA_OFS + 14    // Window Size (16 bit)</span>
<a name="l00116"></a><a class="code" href="tcpip_8h.html#4dc5eca4e46ac8e0f2337d0be3a2aa48">00116</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_CHKSUM_OFS       IP_DATA_OFS + 16    // Checksum Field (16 bit)</span>
<a name="l00117"></a><a class="code" href="tcpip_8h.html#9318f22ae5a3f9155ad1d509bb16eb53">00117</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_URGENT_OFS       IP_DATA_OFS + 18    // Urgent Pointer (16 bit)</span>
<a name="l00118"></a><a class="code" href="tcpip_8h.html#688ccefe02416f846e6e7e67a4ba4344">00118</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_DATA_OFS         IP_DATA_OFS + 20    // Frame Data (if no options)</span>
<a name="l00119"></a><a class="code" href="tcpip_8h.html#9fba9d361957423069d17225dc85390e">00119</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_HEADER_SIZE      20                  // size w/o options</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span>
<a name="l00121"></a><a class="code" href="tcpip_8h.html#210d15290fe9f3775afd01ecaadf8307">00121</a> <span class="preprocessor">#define DATA_OFS_MASK        0xF000              // number of 32 bit words in the TCP Header</span>
<a name="l00122"></a>00122 <span class="preprocessor"></span>
<a name="l00123"></a><a class="code" href="tcpip_8h.html#b4e58145c6e6f028e6b94e73b9a9964f">00123</a> <span class="preprocessor">#define TCP_CODE_FIN         0x0001</span>
<a name="l00124"></a><a class="code" href="tcpip_8h.html#641664ad49bd0cfaae29442090280b7a">00124</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_CODE_SYN         0x0002</span>
<a name="l00125"></a><a class="code" href="tcpip_8h.html#f0d00e434919a4a92c899eb823eb480f">00125</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_CODE_RST         0x0004</span>
<a name="l00126"></a><a class="code" href="tcpip_8h.html#7ade791fe9d40053c930256d2a33fdb0">00126</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_CODE_PSH         0x0008</span>
<a name="l00127"></a><a class="code" href="tcpip_8h.html#635d7367d80da74a37be6c2ca1c9b529">00127</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_CODE_ACK         0x0010</span>
<a name="l00128"></a><a class="code" href="tcpip_8h.html#ff3a5619bf01a8ac66487e8256e58d3a">00128</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_CODE_URG         0x0020</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>
<a name="l00130"></a><a class="code" href="tcpip_8h.html#691688604655ea8943d15f14c60027d8">00130</a> <span class="preprocessor">#define TCP_OPT_MSS          0x0204              // Type 2, Option Length 4 (Max. Segment Size)</span>
<a name="l00131"></a><a class="code" href="tcpip_8h.html#3f562f740244fe93d743ec33a63fdadf">00131</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_OPT_MSS_SIZE     4</span>
<a name="l00132"></a>00132 <span class="preprocessor"></span>
<a name="l00133"></a>00133 <span class="comment">// define some TCP standard-ports, useful for testing...</span>
<a name="l00134"></a><a class="code" href="tcpip_8h.html#21139f8e8083e4781048d9c6b01c534a">00134</a> <span class="preprocessor">#define TCP_PORT_ECHO        7                   // echo</span>
<a name="l00135"></a><a class="code" href="tcpip_8h.html#7f9a5b88303301125c5bfa009ca2ae39">00135</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_PORT_DISCARD     9                   // discard</span>
<a name="l00136"></a><a class="code" href="tcpip_8h.html#6923e0e9c9b4d6f1dde61eca863938dd">00136</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_PORT_DAYTIME     13                  // daytime</span>
<a name="l00137"></a><a class="code" href="tcpip_8h.html#2c88edc88482f168dbaadaad48517348">00137</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_PORT_QOTD        17                  // quote of the day</span>
<a name="l00138"></a><a class="code" href="tcpip_8h.html#2fd07d8dc5a35674a0b7aec73532d043">00138</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_PORT_CHARGEN     19                  // character generator</span>
<a name="l00139"></a><a class="code" href="tcpip_8h.html#c55372d514f28b54692f268a1c898da3">00139</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_PORT_HTTP        80                  // word wide web HTTP</span>
<a name="l00140"></a>00140 <span class="preprocessor"></span>
<a name="l00141"></a>00141 <span class="comment">// macros</span>
<a name="l00142"></a><a class="code" href="tcpip_8h.html#32c7c046581f5127f4309d9f340325c7">00142</a> <span class="preprocessor">#define SWAPB(Word)          ((unsigned short)((Word) &lt;&lt; 8) | ((Word) &gt;&gt; 8))</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span>                                                 <span class="comment">// convert little &lt;-&gt; big endian</span>
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 <span class="comment">// typedefs</span>
<a name="l00146"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91">00146</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {                                   <span class="comment">// states of the TCP-state machine</span>
<a name="l00147"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91929f0327e17604ce9713b2a6117bd603">00147</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91929f0327e17604ce9713b2a6117bd603">CLOSED</a>,                                        <span class="comment">// according to RFC793</span>
<a name="l00148"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea9121e214ebac934264f5b9e3ddffae1031">00148</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea9121e214ebac934264f5b9e3ddffae1031">LISTENING</a>,
<a name="l00149"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea913884e45cc6d937b234e2a8c2c933d7e5">00149</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea913884e45cc6d937b234e2a8c2c933d7e5">SYN_SENT</a>,
<a name="l00150"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91fd8e36f3b706499ade0763cf914b99c9">00150</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91fd8e36f3b706499ade0763cf914b99c9">SYN_RECD</a>,
<a name="l00151"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea9181d0d81381abb711562b19a00a4cb9af">00151</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea9181d0d81381abb711562b19a00a4cb9af">ESTABLISHED</a>,
<a name="l00152"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea912ca754767c3666fc17fe7f5bf49e7518">00152</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea912ca754767c3666fc17fe7f5bf49e7518">FIN_WAIT_1</a>,
<a name="l00153"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea911ff416801732ff573184491c86ee7032">00153</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea911ff416801732ff573184491c86ee7032">FIN_WAIT_2</a>,
<a name="l00154"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91dbf32c37bc28f37e44d0fe611d341178">00154</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91dbf32c37bc28f37e44d0fe611d341178">CLOSE_WAIT</a>,
<a name="l00155"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea918ab2cae69d2b33297ab24a5818213f18">00155</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea918ab2cae69d2b33297ab24a5818213f18">CLOSING</a>,
<a name="l00156"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea911b588a108a727c1de55f818cb9ff57eb">00156</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea911b588a108a727c1de55f818cb9ff57eb">LAST_ACK</a>,
<a name="l00157"></a><a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91799374a9f3fbdfc7f7e92c0f9c5627f7">00157</a>   <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91799374a9f3fbdfc7f7e92c0f9c5627f7">TIME_WAIT</a>
<a name="l00158"></a>00158 } <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91">TTCPStateMachine</a>;
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8">00160</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {                                   <span class="comment">// type of last frame sent. used</span>
<a name="l00161"></a><a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8fb58ccf8b7b11505ff2117a10bf6ff61">00161</a>   <a class="code" href="group__uiparp.html#g7a7c46ffaba30477b8c9e3e61bd2e106">ARP_REQUEST</a>,                                   <span class="comment">// for retransmissions</span>
<a name="l00162"></a><a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8cf635bdbe9b92cbe54a4c220a80e7b4d">00162</a>   <a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8cf635bdbe9b92cbe54a4c220a80e7b4d">TCP_SYN_FRAME</a>,
<a name="l00163"></a><a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e85031c08cb88887f05f2fd4ac845f7b5a">00163</a>   <a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e85031c08cb88887f05f2fd4ac845f7b5a">TCP_SYN_ACK_FRAME</a>,
<a name="l00164"></a><a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8b8ad777c36edd8ab871e3b35c84b74db">00164</a>   <a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8b8ad777c36edd8ab871e3b35c84b74db">TCP_FIN_FRAME</a>,
<a name="l00165"></a><a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8fd268a4452661c03f6d3e414166ec057">00165</a>   <a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8fd268a4452661c03f6d3e414166ec057">TCP_DATA_FRAME</a>
<a name="l00166"></a>00166 } <a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8">TLastFrameSent</a>;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="comment">// constants</span>
<a name="l00169"></a>00169 <span class="preprocessor">#ifdef extern                                    // Keil: declarations for modular programming</span>
<a name="l00170"></a>00170 <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#d12566188545ac503be8cf5322ffbea4">MyIP</a>[] =                    <span class="comment">// "MYIP1.MYIP2.MYIP3.MYIP4"</span>
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172   <a class="code" href="tcpip_8h.html#314b8b1509fa2479b6e7e727c746b1ba">MYIP_1</a> + (<a class="code" href="tcpip_8h.html#eea8cae416884fbd2cccb5f77847b4f5">MYIP_2</a> &lt;&lt; 8),                        <span class="comment">// use 'unsigned int' to</span>
<a name="l00173"></a>00173   <a class="code" href="tcpip_8h.html#216d82e83931dc57a7dd266bc4710b11">MYIP_3</a> + (<a class="code" href="tcpip_8h.html#32b76d3842c75612db17d8447af73e50">MYIP_4</a> &lt;&lt; 8)                         <span class="comment">// achieve word alignment</span>
<a name="l00174"></a>00174 };
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#1e960b18fe3381418ebb63fc046c3fc6">SubnetMask</a>[] =              <span class="comment">// "SUBMASK1.SUBMASK2.SUBMASK3.SUBMASK4"</span>
<a name="l00177"></a>00177 {
<a name="l00178"></a>00178   <a class="code" href="tcpip_8h.html#a62261639fc2ca56065fe7ba7a723b19">SUBMASK_1</a> + (<a class="code" href="tcpip_8h.html#94c6f60ffa3a9125f57e905984bb004b">SUBMASK_2</a> &lt;&lt; 8),                  <span class="comment">// use 'unsigned int' to</span>
<a name="l00179"></a>00179   <a class="code" href="tcpip_8h.html#e73a035cb52fc49271110b2619879144">SUBMASK_3</a> + (<a class="code" href="tcpip_8h.html#a0c0b7827c606c156b5a46f9da9b9abd">SUBMASK_4</a> &lt;&lt; 8)                   <span class="comment">// achieve word alignment</span>
<a name="l00180"></a>00180 };
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#f1b4d40b516a87e3c4310fc0a00c1532">GatewayIP</a>[] =               <span class="comment">// "GWIP1.GWIP2.GWIP3.GWIP4"</span>
<a name="l00183"></a>00183 {
<a name="l00184"></a>00184   <a class="code" href="tcpip_8h.html#ffc624fd13af8a29abbb839105d17bd7">GWIP_1</a> + (<a class="code" href="tcpip_8h.html#c3da5f77f50de1aebf8d7a97f5027aa5">GWIP_2</a> &lt;&lt; 8),                        <span class="comment">// use 'unsigned int' to</span>
<a name="l00185"></a>00185   <a class="code" href="tcpip_8h.html#0262b20db4bef5f02cf8aeeeed9737c3">GWIP_3</a> + (<a class="code" href="tcpip_8h.html#00c8d0d97d17a78c7f214ab445222c8b">GWIP_4</a> &lt;&lt; 8)                         <span class="comment">// achieve word alignment</span>
<a name="l00186"></a>00186 };
<a name="l00187"></a>00187 <span class="preprocessor">#else</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#d12566188545ac503be8cf5322ffbea4">MyIP</a>[2];             <span class="comment">// "MYIP1.MYIP2.MYIP3.MYIP4"</span>
<a name="l00189"></a>00189 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#1e960b18fe3381418ebb63fc046c3fc6">SubnetMask</a>[2];       <span class="comment">// "SUBMASK1.SUBMASK2.SUBMASK3.SUBMASK4"</span>
<a name="l00190"></a>00190 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#f1b4d40b516a87e3c4310fc0a00c1532">GatewayIP</a>[2];        <span class="comment">// "GWIP1.GWIP2.GWIP3.GWIP4"</span>
<a name="l00191"></a>00191 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="tcpip_8c.html#7f70f6411b00f6f88c8d8b7b3ef88525">MyMAC</a>[6];             <span class="comment">// "M1-M2-M3-M4-M5-M6"</span>
<a name="l00192"></a>00192 <span class="preprocessor">#endif</span>
<a name="l00193"></a>00193 <span class="preprocessor"></span>
<a name="l00194"></a>00194 <span class="comment">// easyWEB's internal variables</span>
<a name="l00195"></a>00195 <span class="keyword">extern</span> <a class="code" href="tcpip_8h.html#8d19d7deaea56ced25e51abf862fea91">TTCPStateMachine</a> <a class="code" href="tcpip_8h.html#c623d806ffaa27bddb84c36d174fbc5a">TCPStateMachine</a>;         <span class="comment">// perhaps the most important var at all ;-)</span>
<a name="l00196"></a>00196 <span class="keyword">extern</span> <a class="code" href="tcpip_8h.html#4a984d5d0437d51083bfe132cc44a8e8">TLastFrameSent</a> <a class="code" href="tcpip_8h.html#c50287c92d4d387b516e79857965dd0f">LastFrameSent</a>;             <span class="comment">// retransmission type</span>
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#914211fe1ad2b52231e7cac8e26fa0b5">ISNGenHigh</a>;                <span class="comment">// upper word of our Initial Sequence Number</span>
<a name="l00199"></a>00199 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="tcpip_8h.html#02b336844529edc5f1620847e4bccd75">TCPSeqNr</a>;                   <span class="comment">// next sequence number to send</span>
<a name="l00200"></a>00200 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="tcpip_8h.html#94d5a1d023246f498a6ada80b1950a83">TCPUNASeqNr</a>;                <span class="comment">// last unaknowledged sequence number</span>
<a name="l00201"></a>00201                                                  <span class="comment">// incremented AFTER sending data</span>
<a name="l00202"></a>00202 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="tcpip_8h.html#3e363dfdb166984c51816c07ae616dbb">TCPAckNr</a>;                   <span class="comment">// next seq to receive and ack to send</span>
<a name="l00203"></a>00203                                                  <span class="comment">// incremented AFTER receiving data</span>
<a name="l00204"></a>00204 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="tcpip_8h.html#60e22faaa3e9f1ef6b959331161a6a0a">TCPTimer</a>;                   <span class="comment">// inc'd each 262ms</span>
<a name="l00205"></a>00205 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="tcpip_8h.html#e5e99702b96eb65aa1353b5195a1dd7f">RetryCounter</a>;               <span class="comment">// nr. of retransmissions</span>
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="comment">// properties of the just received frame</span>
<a name="l00208"></a>00208 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#ad01865921c29e2d9af1c27e0fd571b5">RecdFrameLength</a>;           <span class="comment">// EMAC reported frame length</span>
<a name="l00209"></a>00209 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#fe6e54c9fd7d344f515c22952cc0a9d0">RecdFrameMAC</a>[3];           <span class="comment">// 48 bit MAC</span>
<a name="l00210"></a>00210 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#f3f33d6a11a96ff1ce71120a72afd1c4">RecdFrameIP</a>[2];            <span class="comment">// 32 bit IP</span>
<a name="l00211"></a>00211 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#6afd1e4dce3bdb9f0891b1ec458c7817">RecdIPFrameLength</a>;         <span class="comment">// 16 bit IP packet length</span>
<a name="l00212"></a>00212 
<a name="l00213"></a>00213 <span class="comment">// the next 3 buffers must be word-aligned!</span>
<a name="l00214"></a>00214 <span class="comment">// (here the 'RecdIPFrameLength' above does that)</span>
<a name="l00215"></a>00215 <span class="preprocessor">#if defined ( __CC_ARM   )</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> __align(4) _TxFrame1[(<a class="code" href="tcpip_8h.html#3106835123967aabc7080e171ce08c5d">ETH_HEADER_SIZE</a> + <a class="code" href="tcpip_8h.html#21bc1a47f469b35f87dc62b1782a207d">IP_HEADER_SIZE</a> + <a class="code" href="tcpip_8h.html#9fba9d361957423069d17225dc85390e">TCP_HEADER_SIZE</a> + <a class="code" href="tcpip_8h.html#2f24f8b939928f6a8e273c70bf765fdf">MAX_TCP_TX_DATA_SIZE</a>)/2];
<a name="l00217"></a>00217 <a class="code" href="easyweb_8c.html#2a624a765564411c0db3a2bee940f8bc">extern</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> __align(4) _TxFrame2[(<a class="code" href="tcpip_8h.html#3106835123967aabc7080e171ce08c5d">ETH_HEADER_SIZE</a> + <a class="code" href="tcpip_8h.html#07fa3b3206b1edb807bd6a8b8faef812">MAX_ETH_TX_DATA_SIZE</a>)/2];
<a name="l00218"></a>00218 <a class="code" href="easyweb_8c.html#2a624a765564411c0db3a2bee940f8bc">extern</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> __align(4) _RxTCPBuffer[<a class="code" href="tcpip_8h.html#6ee5ff4d45449a0bb5c2ab3ca75b9de9">MAX_TCP_RX_DATA_SIZE</a>/2]; <span class="comment">// space for incoming TCP-data</span>
<a name="l00219"></a>00219 <span class="preprocessor">#elif defined ( __ICCARM__ )</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span><span class="preprocessor">#pragma data_alignment=4</span>
<a name="l00221"></a>00221 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> _TxFrame1[(<a class="code" href="tcpip_8h.html#3106835123967aabc7080e171ce08c5d">ETH_HEADER_SIZE</a> + <a class="code" href="tcpip_8h.html#21bc1a47f469b35f87dc62b1782a207d">IP_HEADER_SIZE</a> + <a class="code" href="tcpip_8h.html#9fba9d361957423069d17225dc85390e">TCP_HEADER_SIZE</a> + MAX_TCP_TX_DATA_SIZE)/2];
<a name="l00222"></a>00222 <span class="preprocessor">#pragma data_alignment=4</span>
<a name="l00223"></a>00223 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> _TxFrame2[(<a class="code" href="tcpip_8h.html#3106835123967aabc7080e171ce08c5d">ETH_HEADER_SIZE</a> + MAX_ETH_TX_DATA_SIZE)/2];
<a name="l00224"></a>00224 <span class="preprocessor">#pragma data_alignment=4</span>
<a name="l00225"></a>00225 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> _RxTCPBuffer[MAX_TCP_RX_DATA_SIZE/2]; <span class="comment">// space for incoming TCP-data</span>
<a name="l00226"></a>00226 <span class="preprocessor">#elif defined   (  __GNUC__  )</span>
<a name="l00227"></a>00227 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="group___e_m_a_c___emac_raw.html#g59af7da1a6bc690a91c25ffb643be295">__attribute__</a> ((aligned (4))) _TxFrame1[(<a class="code" href="tcpip_8h.html#3106835123967aabc7080e171ce08c5d">ETH_HEADER_SIZE</a> + <a class="code" href="tcpip_8h.html#21bc1a47f469b35f87dc62b1782a207d">IP_HEADER_SIZE</a> + <a class="code" href="tcpip_8h.html#9fba9d361957423069d17225dc85390e">TCP_HEADER_SIZE</a> + MAX_TCP_TX_DATA_SIZE)/2];
<a name="l00228"></a>00228 <a class="code" href="easyweb_8c.html#2a624a765564411c0db3a2bee940f8bc">extern</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="group___e_m_a_c___emac_raw.html#g59af7da1a6bc690a91c25ffb643be295">__attribute__</a> ((aligned (4))) _TxFrame2[(<a class="code" href="tcpip_8h.html#3106835123967aabc7080e171ce08c5d">ETH_HEADER_SIZE</a> + MAX_ETH_TX_DATA_SIZE)/2];
<a name="l00229"></a>00229 <a class="code" href="easyweb_8c.html#2a624a765564411c0db3a2bee940f8bc">extern</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="group___e_m_a_c___emac_raw.html#g59af7da1a6bc690a91c25ffb643be295">__attribute__</a> ((aligned (4))) _RxTCPBuffer[MAX_TCP_RX_DATA_SIZE/2]; <span class="comment">// space for incoming TCP-data</span>
<a name="l00230"></a>00230 <span class="preprocessor">#endif</span>
<a name="l00231"></a><a class="code" href="tcpip_8h.html#5a87d390431497b5ca08a1b232862b9c">00231</a> <span class="preprocessor"></span><span class="preprocessor">#define TxFrame1      ((unsigned char *)_TxFrame1)</span>
<a name="l00232"></a><a class="code" href="tcpip_8h.html#4af5b81cb8e9d9c695e34505817ee946">00232</a> <span class="preprocessor"></span><span class="preprocessor">#define TxFrame2      ((unsigned char *)_TxFrame2)</span>
<a name="l00233"></a><a class="code" href="tcpip_8h.html#1d38961e7bb8671a0a8455dd22e1acc8">00233</a> <span class="preprocessor"></span><span class="preprocessor">#define RxTCPBuffer   ((unsigned char *)_RxTCPBuffer)</span>
<a name="l00234"></a>00234 <span class="preprocessor"></span>
<a name="l00235"></a>00235 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#4441f8642fce36238c61f1aae0c952dc">TxFrame1Size</a>;              <span class="comment">// bytes to send in TxFrame1</span>
<a name="l00236"></a>00236 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="tcpip_8h.html#6b9ce1d1f062ac0f751e94b8c4fa2661">TxFrame2Size</a>;               <span class="comment">// bytes to send in TxFrame2</span>
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="tcpip_8h.html#5b2221e15747d16f3fe875716a3a4d26">TransmitControl</a>;
<a name="l00239"></a><a class="code" href="tcpip_8h.html#779a6713190d0be5eed50af2d6995286">00239</a> <span class="preprocessor">#define SEND_FRAME1                    0x01</span>
<a name="l00240"></a><a class="code" href="tcpip_8h.html#2689d609c79812b36ac3c338175b9024">00240</a> <span class="preprocessor"></span><span class="preprocessor">#define SEND_FRAME2                    0x02</span>
<a name="l00241"></a>00241 <span class="preprocessor"></span>
<a name="l00242"></a>00242 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="tcpip_8h.html#97d261c053e1fed268d8b19b876fed61">TCPFlags</a>;
<a name="l00243"></a><a class="code" href="tcpip_8h.html#ca2efe7f626b606a234d2d43bbf46d1e">00243</a> <span class="preprocessor">#define TCP_ACTIVE_OPEN                0x01      // easyWEB shall initiate a connection</span>
<a name="l00244"></a><a class="code" href="tcpip_8h.html#dd744f368d101fd7995b63fbdbc7f9c7">00244</a> <span class="preprocessor"></span><span class="preprocessor">#define IP_ADDR_RESOLVED               0x02      // IP sucessfully resolved to MAC</span>
<a name="l00245"></a><a class="code" href="tcpip_8h.html#6faa51a31b7a3b0e27e031a419c67d38">00245</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_TIMER_RUNNING              0x04</span>
<a name="l00246"></a><a class="code" href="tcpip_8h.html#8314cf2479b3d4a620e71b78eb89eef3">00246</a> <span class="preprocessor"></span><span class="preprocessor">#define TIMER_TYPE_RETRY               0x08</span>
<a name="l00247"></a><a class="code" href="tcpip_8h.html#f2259066dab53eac6cef450336d153fd">00247</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_CLOSE_REQUESTED            0x10</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span>
<a name="l00249"></a>00249 <span class="comment">// prototypes</span>
<a name="l00250"></a>00250 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#547747e66b57c642c54f2d3817fc9a03">DoNetworkStuff</a>(<span class="keywordtype">void</span>);
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 <span class="comment">// Handlers for incoming frames</span>
<a name="l00253"></a>00253 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#7346a66e6a3a2aed4c706d6a98531daa">ProcessEthBroadcastFrame</a>(<span class="keywordtype">void</span>);
<a name="l00254"></a>00254 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#4c52e7d4dc21ab1b34e892fb534245df">ProcessEthIAFrame</a>(<span class="keywordtype">void</span>);
<a name="l00255"></a>00255 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#0aa81e0ecb985cb2e6acbf6697a3527c">ProcessICMPFrame</a>(<span class="keywordtype">void</span>);
<a name="l00256"></a>00256 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#890a895f4374b0748bb6f6d3de38f7f4">ProcessTCPFrame</a>(<span class="keywordtype">void</span>);
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 <span class="comment">// fill TX-buffers</span>
<a name="l00259"></a>00259 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#132ab18b3f9c87a224222f7a4d90ea51">PrepareARP_REQUEST</a>(<span class="keywordtype">void</span>);
<a name="l00260"></a>00260 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#8d8dc60f248ef92f9f6402f85a1b55ed">PrepareARP_ANSWER</a>(<span class="keywordtype">void</span>);
<a name="l00261"></a>00261 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#5e4e096b8e902378cbebe14268976424">PrepareICMP_ECHO_REPLY</a>(<span class="keywordtype">void</span>);
<a name="l00262"></a>00262 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#4684ed0805168ebe534846b2d4efecd0">PrepareTCP_FRAME</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> TCPCode);
<a name="l00263"></a>00263 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#4d6da3ddbe9be494cac242bec9b76e19">PrepareTCP_DATA_FRAME</a>(<span class="keywordtype">void</span>);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="comment">// general help functions</span>
<a name="l00266"></a>00266 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#bdefe008fd22691dc590cb796abf35f9">SendFrame1</a>(<span class="keywordtype">void</span>);
<a name="l00267"></a>00267 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#3fa2422c51f288c3fe346e00bd195cec">SendFrame2</a>(<span class="keywordtype">void</span>);
<a name="l00268"></a>00268 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#8ef35a0623988e9efd10599ad252bfdb">TCPStartRetryTimer</a>(<span class="keywordtype">void</span>);
<a name="l00269"></a>00269 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#787500e69369d01d18d1eb8197c7da6b">TCPStartTimeWaitTimer</a>(<span class="keywordtype">void</span>);
<a name="l00270"></a>00270 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#6ac9404f2bbc31727e1211987db83250">TCPRestartTimer</a>(<span class="keywordtype">void</span>);
<a name="l00271"></a>00271 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#1e82ba1837e7ebb6a50344f03b7b0cea">TCPStopTimer</a>(<span class="keywordtype">void</span>);
<a name="l00272"></a>00272 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#48930bec34f6876f5230d93fd9ce7081">TCPHandleRetransmission</a>(<span class="keywordtype">void</span>);
<a name="l00273"></a>00273 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#66a7bdf2dabfe6bd8cba5cc0304c0f35">TCPHandleTimeout</a>(<span class="keywordtype">void</span>);
<a name="l00274"></a>00274 <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8c.html#8c2b5fd0c78ff9459724bd21ca65827c">CalcChecksum</a>(<span class="keywordtype">void</span> *Start, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Count, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> IsTCP);
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 <span class="comment">// functions to work with big-endian numbers</span>
<a name="l00277"></a>00277 <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8c.html#9446da6828ab23c82fe2f29b9eccdc65">SwapBytes</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Data);
<a name="l00278"></a>00278 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#5105c45db4f3f6f2a205b246bd45b47f">WriteWBE</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *Add, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Data);
<a name="l00279"></a>00279 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#f8d9732a041efca335e05733673a13cb">WriteDWBE</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *Add, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Data);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">// easyWEB-API functions</span>
<a name="l00282"></a>00282 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#af58e3872f99a532df782e434b043830">TCPLowLevelInit</a>(<span class="keywordtype">void</span>);                      <span class="comment">// setup timer, LAN-controller, flags...</span>
<a name="l00283"></a>00283 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#f2b5ece140b96ad5c17f8dc17fbf7f03">TCPPassiveOpen</a>(<span class="keywordtype">void</span>);                       <span class="comment">// listen for a connection</span>
<a name="l00284"></a>00284 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#0bbfedca4e46a76d7b5834a6ce5f999e">TCPActiveOpen</a>(<span class="keywordtype">void</span>);                        <span class="comment">// open connection</span>
<a name="l00285"></a>00285 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#cfc0e8e28fc7f5705dc88a730aa5db41">TCPClose</a>(<span class="keywordtype">void</span>);                             <span class="comment">// close connection</span>
<a name="l00286"></a>00286 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#594a6cd2c86d28d44d10ea4eb4f304b1">TCPReleaseRxBuffer</a>(<span class="keywordtype">void</span>);                   <span class="comment">// indicate to discard rec'd packet</span>
<a name="l00287"></a>00287 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#1b2e6011170f5d0488552c4b6216921d">TCPTransmitTxBuffer</a>(<span class="keywordtype">void</span>);                  <span class="comment">// initiate transfer after TxBuffer is filled</span>
<a name="l00288"></a>00288 <span class="comment">//void TCPClockHandler(void) __irq;                // Keil: interrupt service routine for timer 0</span>
<a name="l00289"></a>00289 <span class="keywordtype">void</span> <a class="code" href="tcpip_8c.html#gb5e09814056d617c521549e542639b7e" title="SysTick handler sub-routine (1ms).">SysTick_Handler</a> (<span class="keywordtype">void</span>);                                            <span class="comment">// NXP: System tick timer is replaced for TCPClockHandler()</span>
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 <span class="comment">// easyWEB-API global vars and flags</span>
<a name="l00293"></a>00293 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#957a8f212f5e6c03aaf2334361003c9e">TCPRxDataCount</a>;            <span class="comment">// nr. of bytes rec'd</span>
<a name="l00294"></a>00294 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#a4685f94119a1295bbb609f9dc8c71a5">TCPTxDataCount</a>;            <span class="comment">// nr. of bytes to send</span>
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#7ff29cba20ed695ca6cbdbadf82c08e8">TCPLocalPort</a>;              <span class="comment">// TCP ports</span>
<a name="l00297"></a>00297 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#cc453d3263ec1bf0073d164cb3427b1a">TCPRemotePort</a>;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#c8092a687665c436de9faf16853d2276">RemoteMAC</a>[3];              <span class="comment">// MAC and IP of current TCP-session</span>
<a name="l00300"></a>00300 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tcpip_8h.html#f84b2647bca5c70d480a674a937c0f53">RemoteIP</a>[2];
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="tcpip_8h.html#053e31898703496056bfcc27c518476e">SocketStatus</a>;
<a name="l00303"></a><a class="code" href="tcpip_8h.html#981f2cbabc281c1874f616446554b07d">00303</a> <span class="preprocessor">#define SOCK_ACTIVE                    0x01      // state machine NOT closed</span>
<a name="l00304"></a><a class="code" href="tcpip_8h.html#0c5844aebccf04243596b04a1d3e6b46">00304</a> <span class="preprocessor"></span><span class="preprocessor">#define SOCK_CONNECTED                 0x02      // user may send &amp; receive data</span>
<a name="l00305"></a><a class="code" href="tcpip_8h.html#c0de067b57b1a25893b4b319687050cb">00305</a> <span class="preprocessor"></span><span class="preprocessor">#define SOCK_DATA_AVAILABLE            0x04      // new data available</span>
<a name="l00306"></a><a class="code" href="tcpip_8h.html#c53341d2a68a06ec28e0c62c3d54cadf">00306</a> <span class="preprocessor"></span><span class="preprocessor">#define SOCK_TX_BUF_RELEASED           0x08      // user may fill buffer</span>
<a name="l00307"></a>00307 <span class="preprocessor"></span>
<a name="l00308"></a><a class="code" href="tcpip_8h.html#0c79b9c6093b78a609aa7827d29bb839">00308</a> <span class="preprocessor">#define SOCK_ERROR_MASK                0xF0      // bit-mask to check for errors</span>
<a name="l00309"></a><a class="code" href="tcpip_8h.html#1b871fb2ca1a293f3f7bfb8eebaadee8">00309</a> <span class="preprocessor"></span><span class="preprocessor">#define SOCK_ERR_OK                    0x00      // no error</span>
<a name="l00310"></a><a class="code" href="tcpip_8h.html#c5a753576fce6bb6351f8dc2428671e3">00310</a> <span class="preprocessor"></span><span class="preprocessor">#define SOCK_ERR_ARP_TIMEOUT           0x10      // timeout waiting for an ARP-REPLY</span>
<a name="l00311"></a><a class="code" href="tcpip_8h.html#1fc9c192157d2f68fbb57d29e5f96ff0">00311</a> <span class="preprocessor"></span><span class="preprocessor">#define SOCK_ERR_TCP_TIMEOUT           0x20      // timeout waiting for an ACK</span>
<a name="l00312"></a><a class="code" href="tcpip_8h.html#35e4eb9bae5c88ce6d5821c45d686ed9">00312</a> <span class="preprocessor"></span><span class="preprocessor">#define SOCK_ERR_CONN_RESET            0x30      // connection was reset by the other TCP</span>
<a name="l00313"></a><a class="code" href="tcpip_8h.html#f0df10d3caa15f98dfb48bf3b296601d">00313</a> <span class="preprocessor"></span><span class="preprocessor">#define SOCK_ERR_REMOTE                0x40      // remote TCP caused fatal error</span>
<a name="l00314"></a><a class="code" href="tcpip_8h.html#4a837f41a7f2ef6f755a38913d23ab9e">00314</a> <span class="preprocessor"></span><span class="preprocessor">#define SOCK_ERR_ETHERNET              0x50      // network interface error (timeout)</span>
<a name="l00315"></a>00315 <span class="preprocessor"></span>
<a name="l00316"></a>00316 <span class="comment">// easyWEB-API buffer-pointers</span>
<a name="l00317"></a><a class="code" href="tcpip_8h.html#b711f3e9e3b2ac1bcf5e8ef091a8985d">00317</a> <span class="preprocessor">#define TCP_TX_BUF      ((unsigned char *)TxFrame1 + ETH_HEADER_SIZE + IP_HEADER_SIZE + TCP_HEADER_SIZE)</span>
<a name="l00318"></a><a class="code" href="tcpip_8h.html#7989527bf6cb93fb13b8c025e2bde24c">00318</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_RX_BUF      ((unsigned char *)RxTCPBuffer)</span>
<a name="l00319"></a>00319 <span class="preprocessor"></span>
<a name="l00320"></a>00320 <span class="preprocessor">#endif</span>
<a name="l00321"></a>00321 <span class="preprocessor"></span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Jun 7 14:58:59 2011 for LPC1700CMSIS Standard Peripheral Firmware Library Manual by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
